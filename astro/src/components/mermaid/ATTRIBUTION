Copied from Julian Cataldo â€” https://www.juliancataldo.com and then heavily modified to work for FusionAuth.