---
import Diagram from "../../../components/mermaid/SequenceDiagram.astro";
const { alt } = Astro.props;

//language=Mermaid
const diagram = `
sequenceDiagram
    participant Browser as User Agent
    participant WebApp as Relying Party
    participant AuthProvider as IDP

    Browser->>WebApp: 1. Navigate to protected resource
    WebApp->>Browser: 2. Redirect to login page
    Browser->>WebApp: 3. User clicks "Login" button
    WebApp->>Browser: 4. Redirect to Auth Provider
    Browser->>AuthProvider: 5. Load authentication page
    AuthProvider->>Browser: 6. Display login form
    Browser->>AuthProvider: 7. Submit credentials (username/password, passkey, etc)
    AuthProvider->>AuthProvider: 8. Validate credentials
    alt Credentials Valid
    Note over WebApp: Valid Credentials
        AuthProvider->>Browser: 9a. Redirect with authentication success
        WebApp->>WebApp: 10a. Create user session
        WebApp->>Browser: 10a. Redirect to protected resource
        Browser->>WebApp: 11a. Access protected resource
        WebApp->>Browser: 12a. Return protected content
    else Credentials Invalid
    Note over WebApp: Invalid Credentials
        AuthProvider->>Browser: 9b. Display error message
        Browser->>AuthProvider: 10b. User retries or exits
    end
`;
---
<Diagram code={diagram} alt={alt} />

