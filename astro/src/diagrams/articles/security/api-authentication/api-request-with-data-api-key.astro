---
import Diagram from "../../../../components/mermaid/SequenceDiagram.astro";
const { alt } = Astro.props;

//language=Mermaid
const diagram = `
sequenceDiagram

actor User as User/Client
participant API as API Server
participant CA as Central Authority
User ->> CA : Authenticate
User ->> CA : Request API key
CA ->> CA : Generate API key:<br/>emORxy...
CA ->> CA : Store API key with<br/>expiration timestamp<br/>and other attributes
CA ->> User : Present API key:<br/>emORxy...
User ->> User : Store API key locally for future use
Note right of User : ... Time passes ...
User ->> API : Get todos<br/>Authorization: emORxy...
API ->> API : Hashes API key
API ->> CA : Is key valid?
CA ->> CA : Checks timestamp
CA ->> CA : Checks key value
CA ->> API : Yes
API ->> API : Extract other data from key<br/>to check validity
API ->> User : Todos data
`;
---
<Diagram code={diagram} alt={alt}/>
