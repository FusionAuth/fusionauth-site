---
import Diagram from "../../../../components/mermaid/SequenceDiagram.astro";
const { alt } = Astro.props;

//language=Mermaid
const diagram = `
sequenceDiagram

actor User as User/Client
participant API as API Server
participant CA as Central Authority
User ->> CA : Authenticate
User ->> CA : Request API key
CA ->> CA : Generate API key:<br/>emORxy...
CA ->> CA : Generate Refresh API key:<br/>e7uxiuZ...
CA ->> CA : Store API and Refresh API key
CA ->> User : Present keys
User ->> User : Store keys locally for future use
Note right of User : ... Time passes ...
User ->> API : Get todos<br/>Authorization: emORxy...
API ->> CA : Is key valid?
CA ->> CA : Checks factors
CA ->> API : Yes
API ->> User : Todos data
Note right of User : ... Time passes ...
User ->> API : Get todos<br/>Authorization: emORxy...
API ->> CA : Is key valid?
CA ->> CA : Checks factors
CA ->> API : No
API ->> User : Todos data
User ->> CA : Present Refresh API key
CA ->> CA : Generate API key:<br/>mGWlVz...
CA ->> CA : Store new API key
CA ->> User : Present key
User ->> User : Store key locally 
User ->> API : Get todos<br/>Authorization: mGWlVz...
API ->> CA : Is key valid?
CA ->> CA : Checks factors
CA ->> API : Yes
API ->> User : Todos data
`;
---
<Diagram code={diagram} alt={alt}/>
