---
import Diagram from "../../../../components/mermaid/Diagram.astro";
const { alt } = Astro.props;

//language=Mermaid
const diagram = `
sequenceDiagram
    participant Browser
    participant z as Zendesk
    participant FusionAuth as Identity Provider (IdP)
    participant g as Gusto

    Browser ->> z : Requests App
    z ->> z : Check Session Existence, Session Missing
    z ->> Browser : Redirect to IdP With a Signed AuthNRequest (XML)
    Browser ->> FusionAuth : Request Login Page
    FusionAuth ->> FusionAuth : Validate AuthNRequest (XML)
    FusionAuth ->> FusionAuth : Check IdP Session Existence (Doesn't Exist)
    FusionAuth ->> Browser : Send Login Page
    Browser ->> FusionAuth : Send Credentials Of User
    FusionAuth ->> Browser : Redirects to Zendesk With a Response (XML)
    Browser ->> z : Requests App and Provides Response (XML)
    z ->> z : Processes Response (XML)
    z ->> Browser : Sends App
    Browser ->> g : Requests App
    g ->> g : Check Session Existence, Session Missing
    g ->> Browser : Redirect to IdP With a Signed AuthNRequest (XML)
    Browser ->> FusionAuth : Request Login Page
    FusionAuth ->> FusionAuth : Validate AuthNRequest (XML)
    FusionAuth ->> FusionAuth : Check IdP Session Existence (Exists)
    FusionAuth ->> Browser : Redirects to Gusto With a Response (XML)
    Browser ->> g : Requests App and Provides Response (XML)
    g ->> g : Processes Response (XML)
    g ->> Browser : Sends App 
`;
---
<Diagram code={diagram} alt={alt} />
