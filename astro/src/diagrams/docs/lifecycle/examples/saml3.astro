---
import Diagram from 'src/components/mermaid/SequenceDiagram.astro';

const { alt } = Astro.props;

//language=Mermaid
const code = `
sequenceDiagram
  actor User

  User->>Changebank: Browse to login page
  activate Changebank
  Changebank->>User: Redirect to FusionAuth OAuth login page
  deactivate Changebank

  User->>FusionAuth: Request OAuth login page
  activate FusionAuth
  Note right of FusionAuth: User clicks "Log in with SAML"
  FusionAuth->>User: Redirect user to Corpo SAML login page
  deactivate FusionAuth

  User->>Corpo: Send username & password
  activate Corpo
  Note right of Corpo: Authenticate user
  Corpo->>User: Redirect user to FusionAuth callback page
  deactivate Corpo

  User->>FusionAuth: Request callback page
  activate FusionAuth
  Note right of FusionAuth: Check authentication cookie
  Note right of FusionAuth: Register user in database
  FusionAuth->>User: Redirect to Changebank callback page
  deactivate FusionAuth

  User->>Changebank: Request callback page
  activate Changebank
  Note right of Changebank: Check authentication cookie
  Changebank->>User: Redirect to account page
  deactivate Changebank

  User->>Changebank: Request account page
  activate Changebank
  Changebank->>User: Return account page
  deactivate Changebank
`;

---
<Diagram {code} {alt} />
