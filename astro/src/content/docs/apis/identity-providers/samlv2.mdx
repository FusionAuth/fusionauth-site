---
title: SAML v2
description: APIs for creating, retrieving, updating and deleting SAML v2 identity providers
section: apis
subcategory: identity providers
---
import Aside from 'src/components/Aside.astro';
import SamlConfigUrls from 'src/content/docs/apis/identity-providers/_saml-config-urls.mdx';
import APIAuthentication from 'src/components/api/APIAuthentication.astro';
import APIURI from 'src/components/api/APIURI.astro';
import InlineField from 'src/components/InlineField.astro';
import APIBlock from 'src/components/api/APIBlock.astro';
import APIField from 'src/components/api/APIField.astro';
import Samlv2RequestBody from 'src/content/docs/apis/identity-providers/_samlv2-request-body.mdx';
import StandardPostResponseCodes from 'src/content/docs/apis/_standard-post-response-codes.astro';
import Samlv2ResponseBody from 'src/content/docs/apis/identity-providers/_samlv2-response-body.mdx';
import StandardGetResponseCodes from 'src/content/docs/apis/_standard-get-response-codes.astro';
import GenericUpdateExplanationFragment from 'src/content/docs/apis/_generic-update-explanation-fragment.mdx';
import PatchSupport from 'src/content/docs/apis/_patch-support.astro';
import StandardPutResponseCodes from 'src/content/docs/apis/_standard-put-response-codes.astro';
import StandardDeleteResponseCodes from 'src/content/docs/apis/_standard-delete-response-codes.astro';
import IdentityProviderStartRequestBody from 'src/content/docs/apis/identity-providers/_identity-provider-start-request-body.mdx';
import IdentityProviderStartResponseBody from 'src/content/docs/apis/identity-providers/_identity-provider-start-response-body.astro';
import SamlCompleteUserRegistration from 'src/content/docs/apis/identity-providers/_saml-complete-user-registration.mdx';
import XForwardedForHeader from 'src/content/docs/apis/identity-providers/_x-forwarded-for-header.mdx';
import XFusionauthTenantIdHeaderScopedOperationRowOnly from 'src/content/docs/apis/_x-fusionauth-tenant-id-header-scoped-operation-row-only.mdx';
import IdentityProviderLoginRequestBody from 'src/content/docs/apis/identity-providers/_identity-provider-login-request-body.astro';
import IdentityProviderLoginResponseBody from 'src/content/docs/apis/identity-providers/_identity-provider-login-response-body.mdx';

export const idp_since = 10600;
export const idp_display_name = 'SAML v2';
export const idp_linking_strategy = 'LinkByEmail';
export const samlv2_idp_initiated = false;

## Overview

<Aside type="version">
This API has been available since 1.6.0
</Aside>

SAML v2 identity providers connect to external SAML v2 login systems. This type of login will optionally provide a `Login with ...` button on FusionAuth's login page. This button is customizable by using different properties of the identity provider.

Optionally, this identity provider can define one or more domains it is associated with. This is useful for allowing employees to log in with their corporate credentials. As long as the company has an identity solution that provides SAML v2, you can leverage this feature. This is referred to as a **Domain Based Identity Provider**. If you enable domains for an identity provider, the `Login with ...` button will not be displayed. Instead, only the `email` form field will be displayed initially on the FusionAuth login page. Once the user types in their email address, FusionAuth will determine if the user is logging in locally or if they should be redirected to this identity provider. This is determined by extracting the domain from their email address and comparing it to the domains associated with the identity provider.

FusionAuth will locate the user's email address in the SAML assertion which will be used to create or lookup the existing user. Additional claims from the SAML response can be used to reconcile the User to FusionAuth by using a SAML v2 Reconcile Lambda. Unless you assign a reconcile lambda to this provider, on the `email` address will be used from the available assertions returned by the SAML v2 identity provider.

### Integration Details

The following values will likely be required by your SAML v2 Identity Provider in order to trust FusionAuth as a relying party.

These values are autogenerated and viewable within the UI after creating the Identity Provider. They can be viewed by navigating to <strong>Settings -> Identity Providers -> SAMLv2 -> View</strong>.

<SamlConfigUrls />

## Create a SAML v2 Identity Provider

### Request

<APIAuthentication icon="lock">Create a SAML v2 Identity Provider using a randomly generated Id</APIAuthentication>
<APIURI method="POST">/api/identity-provider</APIURI>

<APIAuthentication icon="lock">Create a SAML v2 Identity Provider with the provided unique id</APIAuthentication>
<APIURI method="POST">/api/identity-provider/`{identityProviderId}`</APIURI>

The <InlineField>type</InlineField> property in the request JSON indicates you are managing a SAML v2 identity provider.

#### Request Parameters

<APIBlock>
  <APIField name="identityProviderId" type="UUID" optional defaults="secure random UUID">
    The Id to use for the new Identity Provider. If an id is not provided, a secure random UUID is generated.
  </APIField>
</APIBlock>

<Samlv2RequestBody idp_display_name={idp_display_name}
                   idp_since={idp_since}
                   idp_linking_strategy={idp_linking_strategy}
                   samlv2_idp_initiated={samlv2_idp_initiated} />

### Response

<StandardPostResponseCodes never_search_error />

<Samlv2ResponseBody idp_display_name={idp_display_name}
                    idp_since={idp_since}
                    idp_linking_strategy={idp_linking_strategy}
                    samlv2_idp_initiated={samlv2_idp_initiated}/>

## Retrieve a SAML v2 Identity Provider

### Request
<APIAuthentication icon="lock">Retrieve an Identity Provider by Id</APIAuthentication>
<APIURI method="GET">/api/identity-provider/`{identityProviderId}`</APIURI>

#### Request Parameters

<APIBlock>
  <APIField name="identityProviderId" type="UUID" required>
    The unique Id of the SAML v2 Identity Provider to retrieve.
  </APIField>
</APIBlock>

### Response

<StandardGetResponseCodes never_search_error />

<Samlv2ResponseBody idp_display_name={idp_display_name}
                    idp_since={idp_since}
                    idp_linking_strategy={idp_linking_strategy}
                    samlv2_idp_initiated={samlv2_idp_initiated}/>

## Update a SAML v2 Identity Provider

<GenericUpdateExplanationFragment capitalized_object_name="SAML v2 Identity Provider" />

### Request

<APIAuthentication icon="lock">Update an Identity Provider</APIAuthentication>
<APIURI method="PUT">/api/identity-provider/`{identityProviderId}`</APIURI>

<PatchSupport api_endpoint="/api/identity-provider/`{identityProviderId}`" />

#### Request Parameters

<APIBlock>
  <APIField name="identityProviderId" type="UUID" required>
    The unique Id of the SAML v2 Identity Provider to update.
  </APIField>
</APIBlock>

<Samlv2RequestBody idp_display_name={idp_display_name}
                   idp_since={idp_since}
                   idp_linking_strategy={idp_linking_strategy}
                   samlv2_idp_initiated={samlv2_idp_initiated} />

### Response

The response for this API contains the SAML v2 Identity Provider that was updated.

<StandardPutResponseCodes never_search_error />

<Samlv2ResponseBody idp_display_name={idp_display_name}
                    idp_since={idp_since}
                    idp_linking_strategy={idp_linking_strategy}
                    samlv2_idp_initiated={samlv2_idp_initiated}/>

## Delete a SAML v2 Identity Provider

### Request

<APIAuthentication icon="lock">Delete a SAML v2 Identity Provider by Id</APIAuthentication>
<APIURI method="DELETE">/api/identity-provider/`{identityProviderId}`</APIURI>

#### Request Parameters

<APIBlock>
  <APIField name="identityProviderId" type="UUID" required>
    The unique Id of the SAML v2 Identity Provider to delete.
  </APIField>
</APIBlock>

### Response

This API does not return a JSON response body.

<StandardDeleteResponseCodes never_search_error />

## Start a SAML v2 Login Request

<Aside type="version">
This API has been available since 1.19.0
</Aside>

This API is used to initiate a SAML v2 login request when integrating without the FusionAuth hosted login pages.

The SAML v2 AuthN request will require a unique request identifier. This API must be used to record this identifier prior to sending the SAML response from the IdP to FusionAuth in order to protect against SAML response replay attacks. You may optionally provide an identifier to this API if you need to generate your own identifier, or use the generated value provided in the API response.

### Request

<APIAuthentication icon="unlock">Start a login request</APIAuthentication>
<APIURI method="POST">/api/identity-provider/start</APIURI>

<IdentityProviderStartRequestBody idp_display_name={idp_display_name}
                                  idp_since={idp_since}
                                  idp_linking_strategy={idp_linking_strategy}/>

### Response

The response for this API contains a code that can be used to complete the login request.

<IdentityProviderStartResponseBody idp_display_name={idp_display_name}
                                   idp_since={idp_since}
                                   idp_linking_strategy={idp_linking_strategy}/>

## Complete a SAML v2 Login

This API allows you to complete a SAML v2 login after the user has authenticated with a SAML v2 identity provider. If you are using the FusionAuth login UI with the SAML v2 button you will not utilize this API directly.

This API is intended to be used if you want to build your own login page and you have added a SAML v2 login button to this page.

For example, if you built your own login page, you could add a Login with Pied Piper button to utilize a third party SAML v2 identity provider. When the user completes the SAML v2 login step, they will be redirected back to your application. This is done via a form submit (using the HTTP `POST` method). This `POST` will contain a parameter named `SAMLResponse`. Using this API you can pass the `SAMLResponse` returned from the SAML v2 provider to FusionAuth and we will complete the login workflow and reconcile the user to FusionAuth.

<SamlCompleteUserRegistration />

### Request

<APIAuthentication icon="unlock">Complete SAML v2 Login</APIAuthentication>
<APIURI method="POST">/api/identity-provider/login</APIURI>

#### Request Headers

<APIBlock>
  <XForwardedForHeader />
  <XFusionauthTenantIdHeaderScopedOperationRowOnly />
</APIBlock>

<IdentityProviderLoginRequestBody idp_display_name={idp_display_name}
                                  idp_since={idp_since}
                                  idp_linking_strategy={idp_linking_strategy}/>

### Response

The response for this API contains the User object.

<IdentityProviderLoginResponseBody idp_display_name={idp_display_name}
                                   idp_since={idp_since}
                                   idp_linking_strategy={idp_linking_strategy}/>
