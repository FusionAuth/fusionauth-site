import InlineField from 'src/components/InlineField.astro';
import APIBlock from 'src/components/api/APIBlock.astro';
import APIField from 'src/components/api/APIField.astro';
import WebauthnTransports from 'src/content/docs/apis/_webauthn-transports.mdx';
import JSON from 'src/components/JSON.astro';

#### Response Body

The response body contains `options` to be passed to the [WebAuthn JavaScript API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API). The <InlineField>options.challenge</InlineField> and <InlineField>options.allowCredentials``[x]``.id</InlineField> fields must be converted to ``ArrayBuffer``s for the `navigator.credentials.get()` request. See [WebAuthn JavaScript API Binary Format](/docs/apis/webauthn#webauthn-javascript-api-binary-format) for details.

<APIBlock>
  <APIField name="options" type="Object">
    The WebAuthn public key credential request options. This object is passed to the [WebAuthn JavaScript API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API) to generate an assertion using an available passkey.
  </APIField>
  <APIField name="options.allowCredentials" type="Array">
    An array containing identifying information for passkeys that are allowed to complete this authentication ceremony, ordered from most to least preferred.
  </APIField>
  <APIField name="options.allowCredentials[x].id" type="String">
    The credential Id generated by the authenticator as a base64url-encoded string. This value is used to locate an authenticator that can complete the ceremony.

    See [Converting base64url-encoded String to ArrayBuffer](/docs/apis/webauthn#converting-base64url-encoded-string-to-arraybuffer) for details on converting these values for the [WebAuthn JavaScript API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API) call.
  </APIField>
  <APIField name="options.allowCredentials[x].transports" type="List<String>">
    A list of transport types supported by the authenticator that generated the passkey. This value is used as a hint to help identify authenticators containing one of the <InlineField>options.allowCredentials</InlineField>.

<WebauthnTransports />
  </APIField>
  <APIField name="options.allowCredentials[x].type" type="String">
    The credential type the current passkey refers to. The only value supported by WebAuthn is `public-key`.
  </APIField>
  <APIField name="options.challenge" type="String">
    This field contains a base64url-encoded string that acts as a one-time challenge for the ceremony. This makes WebAuthn resistant to certain kinds of replay attacks.

    See [Converting base64url-encoded String to ArrayBuffer](/docs/apis/webauthn#converting-base64url-encoded-string-to-arraybuffer) for details on converting this value for the [WebAuthn JavaScript API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API) call.
  </APIField>
  <APIField name="options.rpId" type="String">
    The Relying Party Id for this authentication ceremony. Passkeys can only be used to authenticate on sites with the same Relying Party Id with which the passkeys were registered.

    If this value is `null` or omitted, the [WebAuthn JavaScript API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API) will use the browser origin as the Relying Party Id.
  </APIField>
  <APIField name="options.timeout" type="Long">
    The number of milliseconds the Relying Party is willing to wait for the ceremony to complete. This value is treated as a hint and may be overridden by the client. This is an unsigned value.
  </APIField>
  <APIField name="options.userVerification" type="String">
    The Relying Party's user verification requirement. Eligible authenticators will be filtered according to this preference. Possible values are:

    * `discouraged` - The Relying Party does not want user verification to be used.
    * `preferred` - The Relying Party prefers that user verification is used if available but will not fail the ceremony if it is not provided.
    * `required` - The Relying Party requires user verification for the operation.
  </APIField>
</APIBlock>

<JSON title="Example Response JSON" src="webauthn/authenticate-start-response.json" />