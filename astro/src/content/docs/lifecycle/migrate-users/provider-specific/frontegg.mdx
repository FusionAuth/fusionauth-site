---
title: Migration From FrontEgg
description: How to migrate your users from FrontEgg to FusionAuth.
section: lifecycle
subcategory: migrate users
tertcategory: provider specific
prerequisites: Docker, Node
technology: FrontEgg
importCodeRoot: https://raw.githubusercontent.com/ritza-co/fusionauth-import-scripts/frontegg
javaCodeRoot: https://raw.githubusercontent.com/ritza-co/fusionauth-contrib/frontegg
---

import InlineUIElement from 'src/components/InlineUIElement.astro';
import InlineField from 'src/components/InlineField.astro';
import Aside from '/src/components/Aside.astro';
import {RemoteCode} from '@fusionauth/astro-components';
import Identifiers from 'src/content/docs/lifecycle/migrate-users/provider-specific/_identifiers.mdx';
import MappingUserAttributes from 'src/content/docs/lifecycle/migrate-users/provider-specific/_mapping-user-attributes.mdx';
import PremiumEditionBlurb from 'src/content/docs/_shared/_premium-edition-blurb.astro';
import SocialLoginNote from 'src/content/docs/lifecycle/migrate-users/provider-specific/_social-login-note.mdx';
import SocialLoginMigration from 'src/content/docs/lifecycle/migrate-users/provider-specific/_social-login-migration.mdx';
import OtherEntitiesIntro from 'src/content/docs/lifecycle/migrate-users/provider-specific/_other-entities-intro.mdx';
import ScrollRef from 'src/components/ScrollRef.astro';
import WhatNext from 'src/content/docs/lifecycle/migrate-users/provider-specific/_what-next.mdx';
import AdditionalSupport from 'src/content/docs/lifecycle/migrate-users/provider-specific/_additional-support.mdx';

export const migration_source_name = 'FrontEgg';
export const migration_source_dir = 'frontegg';
export const script_supports_social_logins = 'false';

## Overview

This document will help you migrate users from {frontmatter.technology} to FusionAuth.

This guide is a low-level, technical tutorial focusing on calling APIs and preparing data when migrating users from {frontmatter.technology}. To understand how to plan a migration at a higher level, please read the [FusionAuth migration guide](/docs/lifecycle/migrate-users/general-migration).

## Prerequisites

To follow this tutorial, you need:
- [Node.js](https://nodejs.org/en) to run the migration scripts, and npm.
- [FusionAuth](/download). The easiest way to run it locally is to use [Docker](https://docs.docker.com/get-docker/) with the configuration file provided later in this tutorial.

## Planning Considerations

### Obtaining User Data

{frontmatter.technology} allows you to export your user data through their API. But {frontmatter.technology} does not allow you to export user password hashes. This means you cannot migrate your user passwords into FusionAuth and allow your users to log in if you do an offline migration. Your users will have to use the FusionAuth "Forgot password" flow to set a password and log in.

If you are willing to perform a gradual migration, also known as an online migration or slow migration, you can allow your users to log in to {frontmatter.technology} via FusionAuth, and save their passwords to FusionAuth if they are correct. Gradual migrations in FusionAuth use Connectors, a paid feature.

Here is how a full migration process might work:
1. Export all user data from the {frontmatter.technology} API, except passwords.
1. Import the data into FusionAuth.
1. Have a FusionAuth Connector call an intermediary web service you write that calls {frontmatter.technology} with a user's credentials and saves the password to FusionAuth whenever a user logs in. Once you have migrated a large enough fraction of your users' passwords you can switch off the Connector and cancel your {frontmatter.technology} subscription.

This tutorial will follow these steps. If you are content asking your users to reset their passwords, or you use the free version of FusionAuth, you can stop on step two.

### Mapping User Attributes

<MappingUserAttributes migration_source_name={migration_source_name} />

### Social Logins

<SocialLoginNote migration_source_name={migration_source_name} script_supports_social_logins={script_supports_social_logins} />

<SocialLoginMigration />

### Other Entities

<OtherEntitiesIntro migration_source_name={migration_source_name} other_migrated_entities="connections or roles" />

#### Identifiers

When creating an object with the FusionAuth API, you can specify the Id. It must be a [UUID](/docs/reference/data-types#uuids).

This works for users, applications, and tenants, among others.

## Export Users

In this section, you create two sample {frontmatter.technology} users in the web portal and export them with the API.

### {frontmatter.technology} User Structure

{frontmatter.technology} has customers (that's you) that are called Vendors. Each Vendor has customers called Users grouped into Tenants. Tenants are grouped into Environments (such as dev, qa, and prod). Below is their illustration of an example.

<img src={`/img/docs/lifecycle/migrate-users/provider-specific/${migration_source_dir}/users.png`} alt="FrontEgg User Structure" width="1200" />

Note that Tenants are called Accounts in the {frontmatter.technology} web portal. FusionAuth also uses Tenants to group users.

Permissions work slightly differently in the two systems. FusionAuth and {frontmatter.technology} both group Permissions into Roles, and assign Roles to Users. A user then has all the permissions associated with that user's roles.

However, {frontmatter.technology} also supports assigning permissions to directly to a user, through a feature called Features. FusionAuth does not support this. You will have to map Features to Roles in your migration script if you have used features. Below is a {frontmatter.technology} illustration of their permissions structure (which they called Entitlements).

<img src={`/img/docs/lifecycle/migrate-users/provider-specific/${migration_source_dir}/permissions.png`} alt="FrontEgg Entitlements" width="1200" />

### Add Sample Users

If you have existing users, you can use them to follow this migration tutorial. If not, add users as described below.

- Log in to your account at https://portal.frontegg.com.
- Add any environment, like dev.
- In the environment settings, note your <InlineUIElement>Client ID</InlineUIElement>, <InlineUIElement>API Key</InlineUIElement>, and <InlineUIElement>Login URL</InlineUIElement>.
- Change your <InlineUIElement>App URL</InlineUIElement> to `http://localhost:6251`.
- In the environment's <InlineField>Backoffice</InlineField> — <InlineField>Accounts</InlineField>, create a new account (tenant) called `a`.
- In <InlineField>Backoffice</InlineField> — <InlineField>Users</InlineField>, create two new users called `a` and `b` assigned to account `a`. For their email addresses, you can use most web email addresses with an alias. For instance, if you use Gmail or ProtonMail and your address is `me@gmail.com`, you could give the two new users `me+a@gmail.com` and `me+b@gmail.com`.
- In the hamburger menu on the right for each user, click <InlineField>Edit user & Metadata</InlineField>. Give them some JSON metadata, like `{"country": "france"}` and save.
- When you receive the welcome emails for these users, verify them by clicking the link.

You're now done working with the {frontmatter.technology} web portal and have sample user data to test a migration.

### Export The Users With The API

FusionAuth provides export and import scripts under a permissive open-source license. To get the scripts, clone the Git repository.

```sh
git clone https://github.com/FusionAuth/fusionauth-import-scripts
```

The `frontegg` directory contains all the scripts you need for this tutorial, and `frontegg/exampleData` has the output of the scripts.

Navigate to the `frontegg/src` directory.

```sh
cd fusionauth-import-scripts/frontegg/src
```

Install the required npm dependencies by running the following command.

```sh
npm install
```

Export your users from {frontmatter.technology} by running the command below. Use your client ID and API key that you noted in the previous section.

```
node 1_exportUsers.mjs yourclientid yourapikey
```

This will create a `users.json` file in the `src` directory. `users.json` should have user data similar to the one in `exampleData/1_fronteggExport/users.json`.

`1_exportUsers.mjs` makes two calls to the {frontmatter.technology} API:
- `httpClient.get('identity/resources/users/v3')` gets all your users and some basic data on each.
- `httpClient.get('identity/resources/vendor-only/users/v1/' + user.id)` gets comprehensive data for each user, including roles, but not features. There doesn't appear me to be an API method to get features currently.

## Create Roles For Your Users

If you look at `exampleData/1_fronteggExport/users.json` you'll see the users have two roles, `ReadOnly` and `Admin` in the keys.

```json
       "tenants": [
            {
                "tenantId": "1d378739-a1ac-4a79-9d2f-e7eb53e6dcd7",
                "roles": [
                    {
                        "id": "f4c43bb0-d9ae-4837-8a97-8688abcd8404",
                        "vendorId": "0d0c5e4b-6c5c-4a85-96fc-7c17b31ee36a",
                        "tenantId": null,
                        "key": "ReadOnly",
                        "name": "Read Only",
```

You need to add these role names in your FusionAuth application. Users will be linked to an application through a registration object, which includes the role. If the users in your exported data have different role names to the ones in the example data, change them in the script `src/2_addRoles.mjs`. The role UUIDs are random in this script — you can use any you like, including the ones matching the UUIDs of your roles in {frontmatter.technology}.

In order to use this script, you need an instance of FusionAuth running. To start FusionAuth, run the commands below in a new terminal.

```
cd fusionauth-import-scripts/frontegg/fusionAuthDockerFiles
docker compose up
```

FusionAuth will now be running and browsable at `http://localhost:9011`. You can log in to the [FusionAuth admin UI](http://localhost:9011/admin) with `admin@example.com` and `password`. The container is called `fa`.

Now you can run the role creation script below.

```sh
node 2_convertTextToJson.mjs
```

Now in the [FusionAuth admin interface](http://localhost:9011/admin), if you browse to **Applications —> Temp** and click the <InlineUIElement>Manage Roles</InlineUIElement> button, you can see the roles have been added for your sample Application. This Application was created using a bootstrapping feature of FusionAuth called [Kickstart](/docs/get-started/download-and-install/development/kickstart), defined in `fusionauth-import-scripts/frontegg/fusionAuthDockerFiles/kickstart/kickstart.json`. When FusionAuth comes up for the first time, it will look at the `kickstart.json` file and configure FusionAuth to the specified state.

## Import Users

### Prepare Users For Import To FusionAuth

The next script, `3_convertFeUserToFaUser.mjs`, is the most important. It maps the fields of `users.json` to FusionAuth fields. You may wish to alter this script to change which fields are ignored, or where they are mapped.

The script uses `stream-json`, a JSON library that can incrementally read massive files with millions of users. It opens the `users.json` file for reading in the line `new Chain([fs.createReadStream(inputFilename), parser(), new StreamArray(),]);`. For more information, read https://github.com/uhop/stream-json. The `processUsers()` function calls `getFaUserFromUser()` to map the {frontmatter.technology} user to FusionAuth, and then saves them to an `faUsers.json` file.

The `getFaUserFromUser()` function does a few things:
- Maps as many matching fields from {frontmatter.technology} to FusionAuth as possible.
- Create a random UUID in plaintext for the user password. This will require users to create a new password when logging in to your application after migration.
- Stores all {frontmatter.technology} user details that don't map to FusionAuth in the JSON `data` field. This is where the {frontmatter.technology} Metadata field is saved to.
- Adds Registrations (a Role link between a User and an Application) for users. You will need to change these Ids to match those of your application when doing a real migration. This section is marked with `TODO`.

Carefully read this function and make sure that the user information you need is imported correctly. If any information is not needed, you can comment out the related lines.

If you are uncertain about what a user attribute in FusionAuth does, read more in the [user guide](/docs/apis/users), as linked in the [general migration guide](/docs/lifecycle/migrate-users/general-migration) recommended earlier.

In a terminal in the `fusionauth-import-scripts/frontegg/src` directory, run the script with the following command.

```sh
node 3_convertFeUserToFaUser.mjs
```

The script will output users ready for import in the file `faUsers.json`.

### Save The User Details And Hash To FusionAuth

To import the users into FusionAuth, you need to run the Node.js import script.

In a terminal in the `fusionauth-import-scripts/frontegg/src` directory, run the command below.

```sh
node 4_import.mjs
```

This script uses the FusionAuth SDK for Node.js `@fusionauth/typescript-client`. It's used only for a single operation, `fa.importUsers(importRequest)`. For more information, read the [FusionAuth Typescript Client Library](/docs/sdks/typescript) documentation.

This script imports users individually. If this is too slow when running the production migration, wrap the `importUsers()` FusionAuth SDK call in a loop that bundles users in batches of 1000.

### Verify The Import

Log in to the [FusionAuth admin UI](http://localhost:9011/admin) with `admin@example.com` and password `password`. Review the user entries for the test application to ensure the data was correctly imported.

You can manage a user by clicking on the <InlineUIElement>Manage</InlineUIElement> button (black button) to the right of the user in the list of users to review the details of the imported user’s profile. In the <InlineUIElement>Source</InlineUIElement> tab, you can see all the user details as a JSON object.

## Migrate User Passwords Gradually

This final step of the tutorial is optional. Here you learn how to create a Connector for FusionAuth to import your users' passwords individually as each user logs in. If you don't need to do this, please skip to the [conclusion section](#what-to-do-next) below.

<PremiumEditionBlurb />

### Create A User With A Password

The two users you created previously did not have passwords. To create a user with a password that you can use to test authentication, you need to alter your login form in {frontmatter.technology}. In the {frontmatter.technology} web portal, complete the following steps.

- Click <InlineUIElement>Go to builder</InlineUIElement>
- Disable all sign in types on the left, except for <InlineUIElement>Email sign on</InlineUIElement> with <InlineUIElement>Password</InlineUIElement>, which you enable.
- Enable <InlineUIElement>Allow signup</InlineUIElement>.
- Use the buttons at the top right to review and publish this change.

Now visit your app URL that you noted earlier, such as `https://app-dgo95bersinj.frontegg.com/oauth/account/sign-up`. Create a new user with an alias like `myemail+frontegguserc@gmail.com` and password `password`.

Export the new user by rerunning the scripts `1_exportUsers.mjs` and `3_convertFeUserToFaUser.mjs`.

Delete the earlier two users from `faUsers.json` and leave only the object for new user `myemail+frontegguserc@gmail.com`.

Run `4_import.js` to import this user into FusionAuth.

### Configure A Connector Between FusionAuth And {frontmatter.technology}

You now need to configure FusionAuth to point to an intermediary web service between it and {frontmatter.technology} by using a Connector.

<Aside type="note">
For a general overview of Connectors, please see this [video](https://www.youtube.com/watch?v=ks-ppMH6WXw).
</Aside>

In your FusionAuth web interface at https://localhost:9011, browse to <InlineUIElement>Settings</InlineUIElement> — <InlineUIElement>Connectors</InlineUIElement>.

Click <InlineUIElement>Add Generic connector</InlineUIElement>.

Enter the field values below.

- <InlineUIElement>Id</InlineUIElement> — <InlineField>b9a215ed-3078-4339-9638-62416fd20837</InlineField>
- <InlineUIElement>Name</InlineUIElement> — <InlineField>Test</InlineField>
- <InlineUIElement>Authentication URL</InlineUIElement> — <InlineField>http://host.docker.internal:6252</InlineField>
- Enable <InlineUIElement>Debug enabled</InlineUIElement>

In production, you will want to add some basic authentication to your public web service, but it's unnecessary when using your localhost in this tutorial.

- Browse to <InlineUIElement>Tenants</InlineUIElement>.
- Click <InlineUIElement>Edit</InlineUIElement> on the default tenant.
- Click the <InlineUIElement>Connectors</InlineUIElement> tab.
- Click <InlineUIElement>Add policy</InlineUIElement>.
- Select the `Test` connector.
- Enable <InlineUIElement>Migrate user</InlineUIElement> so that the FusionAuth will no longer use {frontmatter.technology} for subsequent logins of the same user.
- Click <InlineUIElement>Submit</InlineUIElement>.
- Move the `Test` policy to the top of the list and click the save icon at the top right.

Your FusionAuth instance now has a connector that points to `http://host.docker.internal:6252` (`host.docker.internal` is your physical machine that Docker runs on). The `test` tenant uses this connector.

### Build An Authentication Intermediary Web Service

 The next step is to write the small service available on port 6252 that forwards the user's name and password to {frontmatter.technology} and returns if the login was successful. If it is successful, then you know the password is correct and can save it, hashed, to FusionAuth.

<Aside type='note'>
Documentation on the inputs and outputs a connector expects is [here](https://fusionauth.io/docs/lifecycle/migrate-users/connectors/generic-connector).
</Aside>

The Connector makes a POST request to the URL you specify, and expects a JSON object back containing a `user`. Although the documentation says you need to return only an Id, the Connector will fail unless you also return an email address for the user.

An example web service is in `src/5_connectorService.mjs`.

This file has an Express.js HTTP POST handler that gets the Id and password from the request, in

```js
app.post('/', async (request, response) => {
```

forwards them to {frontmatter.technology} by calling

```js
await isLoginValid(email, request.body.password);
```

and returns a 404 if they are not valid.

If the credentials are valid, you need to return the user's email and Id stored in the `faUsers.json` file. Unfortunately the {frontmatter.technology} API method you call, `https://docs.frontegg.com/reference/vendoronlyusers_verifyuserpassword`, does not return a user Id. This search is done in

```js
await getUserDetailsFromFile(email);
```

Run this web service now using the command below.

```sh
node 5_connectorService.mjs
```

### Log In With A Test User

In the FusionAuth web interface, browse to Applications and click the magnifying glass next to the `Test` application. Copy the value of the `OAuth IdP login URL:` into your browser address bar, such as `http://localhost:9011/oauth2/authorize?client_id=e9fdb985-9173-4e01-9d73-ac2d60d1dc8e&response_type=code&redirect_uri=http%3A%2F%2Fexample.com`. This URL is a login page for the Test application so that you can test the web service and Connector. You cannot use the normal FusionAuth login page, `http://localhost:9011`, because that is only for administrators.

Log in with the username and password you entered earlier, such as `myemail+frontegguserc@gmail.com` and `password`. You should see your web service say on the console `Request received` and be logged in to the FusionAuth sample application page.

If you log out and log in again with the same user, you'll notice that `Request received` does not show in the web service console. This is because FusionAuth is now using its own authentication service as the original user password has been hashed and saved in the FusionAuth database.

The user has been successfully migrated and {frontmatter.technology} is no longer needed for them.

### Debug

If you encounter errors in this process, try the following:
- View the System Event Logs in the bottom left of the FusionAuth web interface.
- Check that you see the web service on your localhost from within the Docker container by running a command on your host like `curl -X POST http://localhost:6252 -H "Content-Type: application/json" -d '{"password":"p", "loginId":"test@example.com"}'`
- Add `console.log('hello')` lines to the `5_connectorService.mjs` file to see where any errors are occurring.

## What To Do Next

You need to check what roles and features are used in {frontmatter.technology} for your real application and create similar permissions and roles in FusionAuth. Update the sample user conversion script to map the role names from {frontmatter.technology} to the role UUIDs in FusionAuth.

<WhatNext />

## Additional Support

<AdditionalSupport />