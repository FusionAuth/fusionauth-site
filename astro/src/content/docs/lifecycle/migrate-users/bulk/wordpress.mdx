---
title: Migrate From WordPress
description: How to migrate your users from WordPress to FusionAuth
section: lifecycle
subcategory: migrate users
tertcategory: bulk
prerequisites: Docker, Node
importCodeRoot: https://raw.githubusercontent.com/ritza-co/fusionauth-import-scripts/wordpress
javaCodeRoot: https://raw.githubusercontent.com/ritza-co/fusionauth-contrib/wordpress
---

import InlineUIElement from 'src/components/InlineUIElement.astro';
import InlineField from 'src/components/InlineField.astro';
import Aside from '/src/components/Aside.astro';
import {RemoteCode} from '@fusionauth/astro-components';
import AdditionalSupport from 'src/content/docs/lifecycle/migrate-users/bulk/_additional-support.mdx';


- [TODO](#todo)
- [Overview](#overview)
- [Prerequisites](#prerequisites)
- [Planning Considerations](#planning-considerations)
- [Export Users](#export-users)
  - [Start WordPress](#start-wordpress)
  - [Add A New User](#add-a-new-user)
  - [Explore The Users In The Database](#explore-the-users-in-the-database)
    - [wp\_users](#wp_users)
    - [wp\_usermeta](#wp_usermeta)
  - [Export The Users In SQL](#export-the-users-in-sql)
  - [Prepare Users For Import To FusionAuth](#prepare-users-for-import-to-fusionauth)
- [Import Users](#import-users)
  - [Use A WordPress Password Hash Plugin For FusionAuth](#use-a-wordpress-password-hash-plugin-for-fusionauth)
- [Bulk Migration](#bulk-migration)
- [What to Do Next](#what-to-do-next)
- [Additional support](#additional-support)
  - [Hash prefixes and what algorithm they indicate](#hash-prefixes-and-what-algorithm-they-indicate)


## TODO
- copy sections from stytch for hasher
- see Cognito migration guide
- copy over sections
- MappingUserAttributes, OtherEntitiesIntro, Identifiers.

## Overview

## Prerequisites

## Planning Considerations

## Export Users

In this section you create a sample WordPress database in Docker, understand where the user details are kept in the database, and export them with a SQL script.

### Start WordPress

Create a file called `docker-compose.yaml` and insert the code below.

```yaml
# Source: https://hub.docker.com/r/bitnami/wordpress-nginx

version: '2'
services:
  mariadb:
    image: docker.io/bitnami/mariadb:11.2
    container_name: fawp_db
    ports:
      - '3306:3306'
    volumes:
      - './db:/bitnami/mariadb'
    environment:
      # ALLOW_EMPTY_PASSWORD is recommended only for development.
      - ALLOW_EMPTY_PASSWORD=yes
      - MARIADB_USER=wp
      - MARIADB_DATABASE=wp
  wordpress:
    image: docker.io/bitnami/wordpress-nginx:6
    container_name: fawp
    ports:
      - '80:8080'
      - '443:8443'
    volumes:
      - './wp:/bitnami/wordpress'
    depends_on:
      - mariadb
    environment:
      # ALLOW_EMPTY_PASSWORD is recommended only for development.
      - ALLOW_EMPTY_PASSWORD=yes
      - WORDPRESS_DATABASE_HOST=mariadb
      - WORDPRESS_DATABASE_PORT_NUMBER=3306
      - WORDPRESS_DATABASE_USER=wp
      - WORDPRESS_DATABASE_NAME=wp
volumes:
  mariadb_data:
    driver: local
  wordpress_data:
    driver: local
```

Open a terminal in the same folder as the file and run the code below to start a MariaDB and WordPress container.

```sh
mkdir db && mkdir wp && sudo chmod -R 777 ./db ./wp
docker compose up
```

Browse to http://localhost/wp-login.php. Log in with username `user` and password `bitnami`. This is the administrator username.

### Add A New User

If you use WordPress as a user management system you need to allow users to register themselves. To do this, browse to <InlineUIElement>Settings</InlineUIElement> — <InlineUIElement>General</InlineUIElement> — <InlineUIElement>Membership</InlineUIElement>. Enable <InlineUIElement>Anyone can register</InlineUIElement> and click <InlineUIElement>Save Changes</InlineUIElement>.

Log out at the top right of the page. Browse to http://localhost/wp-login.php.
Register a new user. Enter any username and email `a@example.com`.

### Explore The Users In The Database

Browse the database in any database IDE that can connect to MariaDB. [DBeaver](https://dbeaver.io/download/) is a free cross-platform IDE you can use if you don't have one.

Create a new MariaDB connection to localhost, port 3306, database wp, username wp, with no password needed. Open the connection and expand the database tables.

WordPress has to two tables related to users: wp_users and wp_usermeta.

#### wp_users

Below is the data you should have in wp_users. This table holds the user's identifiers and password hash.

ID|user_login|user_pass                         |user_nicename|user_email      |user_url        |user_registered        |user_activation_key                          |user_status|display_name|
---|----------|----------------------------------|-------------|----------------|----------------|-----------------------|---------------------------------------------|-----------|------------
 1|user      |\$P$BVrdsW/NUuXDi0Od0uUdk2SnJHHmQ01|user         |user@example.com|http://127.0.0.1|2024-02-21 07:09:20.000|                                             |          0|user        |
 2|a         |\$P$B/kCzTMDV7ccClaRShJPz8suWQdKc5/|a            |a@example.com   |                |2024-02-21 10:52:53.000|1708512773:\$P$BYELgLl.oz9lv.YRNp7ppBA1GxzOEY0|          0|a           |

Unfortunately neither the [WordPress Codex](https://codex.wordpress.org/Database_Description) nor the [WordPress Developer Handbook](https://developer.wordpress.org) give definitions of the database fields and their meanings. To be certain of their purpose you would need to read the WordPress source code. But the column definitions below given by ChatGPT seem obvious enough to trust.

- ID: A unique identifier for each user. It is an auto-incremented integer and serves as the primary key for the table.
- user_login: The user's username used for logging in to WordPress.
- user_pass: The hashed password for the user.
- user_nicename: A URL-friendly version of the user's username. It is used in the author slug URL.
- user_email: The user's email address. It is unique for each user and used for account management and notifications.
- user_url: The URL of the user's website. This field is optional and can be left blank.
- user_registered: The date and time when the user registered on the WordPress site. It is stored in the 'YYYY-MM-DD HH:MM:SS' format.
- user_activation_key: Used for storing a hash that is used to activate the user's account or for password reset purposes.
- user_status: This field is deprecated and not used by core WordPress functions. It was originally intended for user status but is now typically left at its default value of 0.
- display_name: The publicly displayed name of the user. This name is shown on the site in places like author posts or comments.

#### wp_usermeta

The wp_usermeta table holds all information about a user besides that kept in the wp_users. WordPress plugins can add their own data too. Below is the data you should have in wp_usermeta.

umeta_id|user_id|meta_key                             |meta_value
--------|-------|-------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1|      1|nickname                             |user                                                                                                                                                                                                                                                           |
2|      1|first_name                           |UserName                                                                                                                                                                                                                                                       |
3|      1|last_name                            |LastName                                                                                                                                                                                                                                                       |
4|      1|description                          |                                                                                                                                                                                                                                                               |
5|      1|rich_editing                         |true                                                                                                                                                                                                                                                           |
6|      1|syntax_highlighting                  |true                                                                                                                                                                                                                                                           |
7|      1|comment_shortcuts                    |false                                                                                                                                                                                                                                                          |
8|      1|admin_color                          |fresh                                                                                                                                                                                                                                                          |
9|      1|use_ssl                              |0                                                                                                                                                                                                                                                              |
10|      1|show_admin_bar_front                 |true                                                                                                                                                                                                                                                           |
11|      1|locale                               |                                                                                                                                                                                                                                                               |
12|      1|wp_capabilities                      |a:1:{s:13:"administrator";b:1;}                                                                                                                                                                                                                                |
13|      1|wp_user_level                        |10                                                                                                                                                                                                                                                             |
14|      1|dismissed_wp_pointers                |                                                                                                                                                                                                                                                               |
15|      1|show_welcome_panel                   |1                                                                                                                                                                                                                                                              |
16|      1|session_tokens                       |a:1:{s:64:"ed6949d03244303edfd56de57f46b77a7300c2c62406ccde3b717b700c4fce4a";a:4:{s:10:"expiration";i:1708684580;s:2:"ip";s:10:"172.25.0.1";s:2:"ua";s:101:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.||
17|      1|wp_dashboard_quick_press_last_post_id|4                                                                                                                                                                                                                                                              |
18|      1|community-events-location            |a:1:{s:2:"ip";s:10:"172.25.0.0";}                                                                                                                                                                                                                              |
19|      2|nickname                             |a                                                                                                                                                                                                                                                              |
20|      2|first_name                           |                                                                                                                                                                                                                                                               |
21|      2|last_name                            |                                                                                                                                                                                                                                                               |
22|      2|description                          |                                                                                                                                                                                                                                                               |
23|      2|rich_editing                         |true                                                                                                                                                                                                                                                           |
24|      2|syntax_highlighting                  |true                                                                                                                                                                                                                                                           |
25|      2|comment_shortcuts                    |false                                                                                                                                                                                                                                                          |
26|      2|admin_color                          |fresh                                                                                                                                                                                                                                                          |
27|      2|use_ssl                              |0                                                                                                                                                                                                                                                              |
28|      2|show_admin_bar_front                 |true                                                                                                                                                                                                                                                           |
29|      2|locale                               |                                                                                                                                                                                                                                                               |
30|      2|wp_capabilities                      |a:1:{s:10:"subscriber";b:1;}                                                                                                                                                                                                                                   |
31|      2|wp_user_level                        |0                                                                                                                                                                                                                                                              |
32|      2|default_password_nag                 |1                                                                                                                                                                                                                                                              |

Below are the column definitions for the table.

- umeta_id: A unique identifier for each meta entry. It is an auto-incremented integer and serves as the primary key for the table.
- user_id: The ID of the user to whom the meta entry belongs. It links back to the ID column in the wp_users table.
- meta_key: The name of the metadata field. WordPress uses this field to store various pieces of user-related information, such as administrative capabilities (wp_capabilities), user roles (wp_user_level), and custom user meta added by themes or plugins.
- meta_value: The value of the metadata field. The information here can vary widely depending on the meta_key. This field can store serialized arrays or strings, depending on the type of data being stored.

The wp_usermeta table uses an Entity-Attribute-Value (EAV) model. Instead of having one column for each type of field to store for a user, new fields are added using a key-value combination.

There are some things to note when deciding which fields you want to import to FusionAuth.
- Blank fields, like description, and should be ignored.
- Fields that are specific to WordPress, like rich_editing, can be ignored.
- Some fields are PHP objects serialized into strings, like wp_capabilities with value `a:1:{s:13:"administrator";b:1;}`. This reads as: an array of 1 element containing a string of 13 elements and a boolean of value true. You will need to deserialize these when importing them.
- Legacy fields, like wp_user_level, can be ignored.

Here are some of meta_key types you might find:

- wp_capabilities: Stores the roles assigned to a user in a serialized array. This determines what the user can and cannot do within WordPress.
- wp_user_level: A legacy way to define user roles and capabilities, primarily kept for backward compatibility. It represents the user's role as a numeric level.
- rich_editing: Indicates whether the user prefers to use the visual rich editor when writing. The value is either "true" or "false".
- syntax_highlighting: Indicates whether the user prefers to have syntax highlighting enabled in the code editor. The value is either "true" or "false".
- comment_shortcuts: Indicates whether the user wishes to use keyboard shortcuts for comment moderation. The value is either "true" or "false".
- admin_color: The color scheme the user has chosen for the admin dashboard.
- use_ssl: Whether the user prefers to use SSL when logging into the admin area. The value is either "0" (do not force SSL) or "1" (force SSL).
- show_admin_bar_front: Determines whether the WordPress admin bar should be displayed to the user when viewing the site. The value is either "true" or "false".
- locale: The user's preferred language locale for the admin dashboard.
- wp_dashboard_quick_press_last_post_id: The ID of the last post created using the "Quick Draft" dashboard widget.
- dismissed_wp_pointers: Tracks the admin pointers dismissed by the user to avoid showing them again.
- session_tokens: Stores the user's session tokens for maintaining login sessions across different devices.
- wp_user-settings and wp_user-settings-time: Store user-specific settings for the admin area, such as the true/false status of checkboxes and the timestamp of the last settings update, respectively.

### Export The Users In SQL

Clone the GitHub repository https://github.com/ritza-co/fusionauth-import-scripts.git. The `wordpress` directory contains all the scripts you need for this tutorial, and `exampleData` has the outputs of the scripts.

Install the npm dependencies by running the code below.

```sh
cd wordpress/src
npm install
```

Run the SQL script `src/1_exportWordpressUsers.sql` against your WordPress database to export all the user data as JSON. View the output as text in DBeaver and save the `json_result` column to a file called `users.txt`.

The script exports the `wp_users` table as JSON with all fields related to each user as an array called `meta`.

Your file should look the same as `exampleData/1_wordpressExport/users.txt`. Each row is JSON, but the file as a whole is not JSON. Each row must end with a comma and the whole thing must be wrapped in brackets.

To do this, copy `src/2_convertTextToJson.mjs` into the same directory as your text file and run the code below.

```sh
node 2_convertTextToJson.mjs
```

Your output should now be valid JSON and look like the file `exampleData/1_wordpressExport/users.json`.

### Prepare Users For Import To FusionAuth

The next script is the most important. It maps the fields of `users.json` to FusionAuth fields. You may wish to alter this script to change which fields are ignored, or where they are mapped. The script is `3_convertWpUserToFaUser.mjs`.




## Import Users

### Use A WordPress Password Hash Plugin For FusionAuth

## Bulk Migration

## What to Do Next

Phpass is a relatively old and weak hashing algorithm, though not terrible. You might want to rehash your users' passwords on their next login with a stronger algorithm. To enable this setting, follow these [instructions](/docs/extend/code/password-hashes/custom-password-hashing#rehashing-user-passwords).

## Additional support


Make hasher

Bcrypt example

$2y$10$abcdefghijklmnopqrstuvwx.yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789

algorithm $ cost $ salt . hash.

Phpass - Md5 - Bcrypt

 $P$BVrdsW/NUuXDi0Od0uUdk2SnJHHmQ01, is a WordPress password hash. WordPress uses a modified version of the portable PHP password hashing framework, Phpass. The hash is structured as follows:

    $P$B: This is the prefix indicating the hash type and the cost parameter. $P$ indicates it's a WordPress Phpass hash. The B after $P$ encodes the cost parameter, which determines the computational cost of the hashing algorithm. WordPress typically uses a cost parameter that results in 2^8 (256) iterations of the hashing algorithm.

    VrdsW/NUuXDi0Od0uUdk: This part is the salt used for hashing. The salt is a random value that is combined with the password to produce a unique hash even for identical passwords. In Phpass, the salt is 8 characters long and is encoded together with the hash.

    2SnJHHmQ01: This is the actual hash value of the password, produced by hashing the password together with the salt, using the MD5 algorithm repeatedly for 2^8 iterations (based on the cost parameter).

MD5 Hashes: Early WordPress versions used MD5 for password hashing. These hashes are easily identifiable because they lack a specific prefix indicating a more modern algorithm. They are 32 characters long, hexadecimal.

Phpass Hashes: When WordPress moved to using Phpass, it started using prefixes to indicate the hashing algorithm and cost. A Phpass hash typically starts with $P$B or similar. The $P$ indicates Phpass, and the character following this prefix (e.g., B) indicates the cost parameter. Phpass can use different algorithms, including bcrypt, but it primarily wraps around MD5 for backward compatibility and portability, ensuring a consistent user experience across different server environments.

### Hash prefixes and what algorithm they indicate

WordPress and the Phpass library use specific prefixes in their password hashes to indicate the algorithm and cost parameters used during the hashing process. Here's a breakdown of the possible hash prefixes you might encounter in a WordPress context and what they indicate about the algorithm:

    MD5 Hashes (No Prefix): Early WordPress versions used plain MD5 hashes for passwords. These hashes are 32 characters long and consist of hexadecimal characters (0-9, a-f). They do not have a prefix.

    $P$ or $P$B: This prefix is used by WordPress to indicate hashes created using the Phpass library with a fallback to MD5. The $P$ indicates Phpass, and the character following this prefix represents the cost parameter of the hash. The actual algorithm is a modified MD5 with multiple iterations to increase security. This is the most common format you'll find in WordPress installations that have not been updated to use newer hashing algorithms.

    $1$: This prefix indicates an MD5-based crypt hash. It's not commonly used in WordPress itself but is supported by the Phpass library. It specifies an MD5 hash that's been processed with a Unix crypt() function.

    $2a$, $2x$, $2y$: These prefixes are associated with bcrypt, a more secure hashing algorithm. The $2a$ version had some security concerns and was succeeded by $2y$ for PHP to address compatibility and security issues. $2x$ was a temporary workaround for a specific bug. WordPress with PHP 5.3.7 or newer might use $2y$ for bcrypt hashes if the server supports it.

    $5$ and $6$: These prefixes indicate SHA-256 and SHA-512 hashing respectively, used with the Unix crypt() function. While supported by Phpass, these are not typically used by WordPress.

    $argon2i$, $argon2id$: These prefixes are for Argon2, a modern and secure hashing algorithm that won a Password Hashing Competition and is recommended for new applications. As of my last update, WordPress does not use Argon2 by default, but PHP 7.2+ supports Argon2i and Argon2id for password hashing.

When migrating user passwords or verifying them on a different system, recognizing these prefixes helps determine the necessary steps to authenticate users correctly. For most WordPress migrations, dealing with \$P$ hashes will be the primary concern. To ensure compatibility and security, using a method that can handle these hashes appropriately, potentially upgrading them to a more secure algorithm like bcrypt or Argon2 when users log in, is recommended.

I gotta use the phpass package in java.

TODO add fusionauth-contrib wordpress branch export for tatenda

Maker importer

    wp_capabilities: This meta key indicates the user's capabilities or roles within WordPress. Capabilities define what actions a user can and cannot perform on a WordPress site.

    a:1:{s:13:"administrator";b:1;}: This is a serialized PHP string. Here's what each part means:
        a:1:: This indicates an array with 1 element.
        {: Begins the array.
        s:13:"administrator";: This is a string of 13 characters, "administrator", indicating the role assigned to the user.
        b:1;: This is a boolean value, true, indicating that the capability (or role) is active for the user.
        }: Ends the array.
