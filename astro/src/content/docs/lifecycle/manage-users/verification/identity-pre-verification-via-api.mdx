---
title: Identity Pre-Verification Via API
description: Verify email or phone identities entirely via API without using hosted pages.
navcategory: developer
section: lifecycle
subcategory: manage users
tertcategory: verification
---
import Aside from 'src/components/Aside.astro';
import Breadcrumb from 'src/components/Breadcrumb.astro';
import InlineField from 'src/components/InlineField.astro';
import PremiumPlanBlurb from 'src/content/docs/_shared/_premium-plan-blurb.astro';

## Overview

This guide shows how to verify a user's email or phone identity using FusionAuth APIs only, without hosted pages and Advanced Registration Forms. You will:

1. Start an identity verification flow
2. Optionally send a code to the user
3. Complete verification with the code (or via clickable link)
4. Create the user using the returned verificationId

If you're looking for the hosted pages version with Advanced Registration Forms, see:
- [Email Identity Pre-Verification](/docs/lifecycle/manage-users/verification/mail-identity-verification)
- [Phone Identity Pre-Verification](/docs/lifecycle/manage-users/verification/phone-identity-verification)

## Prerequisites

This guide assumes you are running FusionAuth version 1.62.0 or greater. If you aren't, head on over to the [installation guide](/docs/get-started/download-and-install) or the [upgrade guide](/docs/operate/deploy/upgrade) to update to a version with support for this feature.

<Aside type="note">
  Email/Phone Verification and identity pre-verification are not premium features; however, enforcing pre-verification with Advanced Registration Forms as well as Gating is.
  If you are following this guide implementing pre-verification entirely via API, you can still build equivalent gating in your application logic.
  See the hosted pages guides if you prefer FusionAuth to enforce gating for you.
</Aside>

## General Flow

1. Start Verification Flow
   - POST /api/identity/verify/start
   - Provide the identity value in <InlineField>loginId</InlineField> and the type in <InlineField>loginIdType</InlineField> (`email` or `phoneNumber`).
   - For pre-verifying identities before user creation, set <InlineField>existingUserStrategy</InlineField> to `mustNotExist`.
   - The response includes a <InlineField>verificationId</InlineField> and may include a <InlineField>oneTimeCode</InlineField> if using the `FormField` strategy.

2. Send Code (optional)
   - POST /api/identity/verify/send
   - Provide the <InlineField>verificationId</InlineField>. Use this if you want FusionAuth to send the email or SMS containing the code or clickable link.

3. Complete Verification
   - POST /api/identity/verify/complete
   - Provide the <InlineField>verificationId</InlineField> and, if using the `FormField` strategy, the <InlineField>oneTimeCode</InlineField>.
   - If the strategy is `ClickableLink`, you can validate using just the <InlineField>verificationId</InlineField> (the user clicks the link).

4. Create the User
   - POST /api/user or /api/user/registration
   - Include the <InlineField>verificationIds</InlineField> array from step 1 associated to the verified identity.

<Aside type="note">
  <InlineField>existingUserStrategy</InlineField> values are lowercase: `mustExist` and `mustNotExist`.

  The default <InlineField>verificationStrategy</InlineField> depends on your tenant configuration (for email: `tenant.emailConfiguration.verificationStrategy`; for phone: `tenant.phoneConfiguration.verificationStrategy`), and may be either `ClickableLink` or `FormField`.

  See the [Identity Verify API](/docs/apis/identity-verify) for full details.
  </Aside>

## Using Postman (examples)

These examples assume a local FusionAuth instance at http://localhost:9011 and that you're sending an API key in the headers as required by your configuration. Adjust host, tenant header, and authorization to match your environment.

### 1) Start Verification Flow

- URL: http://localhost:9011/api/identity/verify/start
- Method: POST
- Body:

```json
{
  "existingUserStrategy": "mustNotExist",
  "loginId": "testuser20@example.com",
  "loginIdType": "email"
}
```

- Example result:

```json
{
  "oneTimeCode": "ZLB632",
  "verificationId": "eIXDJDjMYOrcAEPDHdlnzVGIXE1kzjogdiJDBZLLxJg"
}
```

Things to note:
- <InlineField>existingUserStrategy</InlineField> can be `mustNotExist` or `mustExist`.
- The default <InlineField>verificationStrategy</InlineField> comes from the tenant settings and may be `FormField` or `ClickableLink`.

For complete parameter and response details, refer to [Start Identity Verification](/docs/apis/identity-verify#start-identity-verification)

### 2) Send Code (optional)

- URL: http://localhost:9011/api/identity/verify/send
- Method: POST
- Body:

```json
{
  "verificationId": "eIXDJDjMYOrcAEPDHdlnzVGIXE1kzjogdiJDBZLLxJg"
}
```

- Example result: HTTP 200 with an empty body.

Things to note:
- This step is optional. If you already received a <InlineField>oneTimeCode</InlineField> from Start and have another method to deliver it to the user, you may skip sending.
- If you want FusionAuth to send the email or SMS message, call this endpoint to deliver the code or clickable link. Make sure the prerequisite email/message settings are configured.
    - [Email servers](/docs/customize/email-and-messages/configure-email)
    - [Messengers](/docs/customize/email-and-messages/messengers)

For complete parameter and response details, refer to [Send Identity Verification](/docs/apis/identity-verify#send-identity-verification)

### 3) Complete Verification

- URL: http://localhost:9011/api/identity/verify/complete
- Method: POST
- Body (FormField strategy):

```json
{
  "verificationId": "eIXDJDjMYOrcAEPDHdlnzVGIXE1kzjogdiJDBZLLxJg",
  "oneTimeCode": "ZLB632"
}
```

- Example result:

```json
{}
```

Things to note:
- If the <InlineField>verificationStrategy</InlineField> is `ClickableLink`, completing can be done when the user clicks the link sent to them. In that case, completing with just the <InlineField>verificationId</InlineField> will validate the user.

For complete parameter and response details, refer to [Complete Identity Verification](/docs/apis/identity-verify#complete-identity-verification)

### 4) Create the User

- URL: http://localhost:9011/api/user
- Method: POST
- Body:

```json
{
  "verificationIds": [
    "eIXDJDjMYOrcAEPDHdlnzVGIXE1kzjogdiJDBZLLxJg"
  ]
}
```

- Example result: user object where the corresponding identity is marked `verified: true`.

For complete parameter and response details, refer to [Create a User](/docs/apis/users#create-a-user)

Alternatively, you can create the user and registration in a single API call: [Create a User and Registration Combined](/docs/apis/registrations#create-a-user-and-registration-combined)

## Test It Out

TODO Screenshot Application Details http://localhost:9011/admin/application/

You can validate the email or phone verification status by viewing the user in the admin UI by navigating to <Breadcrumb>Users -> [select user] -> Manage</Breadcrumb>. A verified email address or phone number displays a green checkmark icon next to the address.

## Tips and Caveats

- Use `mustNotExist` when verifying identities before creating users; use `mustExist` to verify an identity for an existing user.
- If you choose `FormField`, plan for collecting and submitting the code from the user. If you choose `ClickableLink`, ensure the link is routable for the user and that your tenant/application templates are configured.
- For email, ensure your tenant SMTP settings are configured. For phone, ensure a messenger (for example, Twilio) is configured if you plan to call the Send API.
- If you are running multiple tenants, include the `X-FusionAuth-TenantId` header or provide `applicationId` as appropriate. See the API docs for scoping details.

For complete parameter and response details, refer to the Identity Verify API docs:
- [Start Identity Verification](/docs/apis/identity-verify#start-identity-verification)
- [Send Identity Verification](/docs/apis/identity-verify#send-identity-verification)
- [Complete Identity Verification](/docs/apis/identity-verify#complete-identity-verification)

## Next Steps

Now that you've successfully set up identity pre-verification via API, take the next steps:

* Learn about [customizing email templates](/docs/customize/email-and-messages/email-templates-replacement-variables) used for identity verification.
* Learn about [customizing message templates](/docs/customize/email-and-messages/message-templates-replacement-variables) used for identity verification.
