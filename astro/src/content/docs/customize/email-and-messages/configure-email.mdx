---
title: Configure the SMTP Server
description: Learn how to enable and configure the SMTP server.
section: customize
subcategory: email and messages
---
import InlineField from 'src/components/InlineField.astro';
import APIBlock from 'src/components/api/APIBlock.astro';
import APIField from 'src/components/api/APIField.astro';
import Aside from 'src/components/Aside.astro';

## Overview

Before you can use email templates and other email features, you must first enable and configure an SMTP server.

To enable and configure the SMTP server navigate to <strong>Tenants -> Email</strong>.

<img src="/img/docs/customize/email-and-messages/email-settings.png" alt="Email Settings" width="1200" role="shadowed" />

Enable email by clicking on the *Enabled* toggle, and save your settings once you have completed your configuration.

### SMTP Settings

<APIBlock>
  <APIField name="Host" optional defaults="localhost">
    The hostname of the SMTP server. This will be provided by your SMTP provider.
  </APIField>
  <APIField name="Port" optional defaults="25">
    The port of the SMTP server. This will be provided by your SMTP provider. Ports `25`, `465` and `587` are the well known ports used by SMTP, it is possible your provider will utilize a different port.

    In most cases you will be using TLS to connect to your SMTP server, and the port will generally be `587` or `465`.
  </APIField>
  <APIField name="Username" optional>
    The username used to authenticate to the SMTP server. This will be provided by your SMTP provider.
  </APIField>
  <APIField name="Change password" optional>
    When enabled, you may modify the SMTP password, when the <InlineField>Password</InlineField> field is not displayed the current password will not be modified.
  </APIField>
  <APIField name="Password" required>
    The new password to use for the outgoing SMTP mail server authentication. This field is only required when <InlineField>Change password</InlineField> is checked.
  </APIField>
  <APIField name="Security" optional>
    The security type when using an SSL connection to the SMTP server. This value should be provided by your SMTP provider.

    Generally speaking, if using port `25` you will select `None`, if using port of `465` you will select `SSL` and if using port `587` you will select `TLS`. It is possible your provider will be different, follow your providers instruction.

    * `None`
    * `SSL`
    * `TLS`
  </APIField>
  <APIField name="Default from address" optional>
    The default From Address used in sending emails when a from address is not provided for an individual email template. This is an email address (i.e. **jared@piedpiper.com**).
  </APIField>
  <APIField name="Default from name" optional>
    The default From Name used in sending emails when a from name is not provided on an individual email template. This is the display name part of the email address (i.e. **Jared Dunn**  &lt;jared@piedpiper.com>).
  </APIField>
  <APIField name="Additional headers" optional since="1.32.0">
    One or more line separated SMTP headers to be added to each outgoing email. The header name and value should be separated by an equals sign. (i.e. `X-SES-CONFIGURATION-SET=Value`).
  </APIField>
  <APIField name="Debug enabled" optional since="1.37.0">
    When enabled, SMTP and JavaMail debug information will be output to the Event Log.
  </APIField>
</APIBlock>

## SMTP best practices

todo - put this above providers

- general email best practices
- setting up your SPF and DKIM records
- dedicated IP vs. IP pools and IP reputation
- Anything else that people should consider when setting up SMTP

## SMTP Providers

<Aside type="note">
This information is for starting guidance only - FusionAuth connects seamlessly with many different email providers. A deep exploration of email best practices and providers is outside the scope of this section.
</Aside>

To avoid breaking the various DNS records of your application's domain, you may want to run FusionAuth locally in Docker and point its SMTP fields to a temporary domain. In the examples below, configuration is shown using a free subdomain created with [ClouDNS](https://www.cloudns.com) The examples use the domain `fusionauth.ddns.net`.

Alternatively, you can create a subdomain on your real account. For example, if your application is hosted at `myapp.com`, you can create `testemail.myapp.com`, and point the SMTP service and FusionAuth there while testing.

### SendGrid

SendGrid is a commonly used SMTP provider and integrates well with FusionAuth. To setup SendGrid, [follow these instructions](https://docs.sendgrid.com/for-developers/sending-email/integrating-with-the-smtp-api).

Other resources related to SendGrid are linked below:

1. https://docs.sendgrid.com/for-developers/sending-email/getting-started-with-transactional-emails
2. https://docs.sendgrid.com/for-developers/sending-email/sender-identity
3. https://docs.sendgrid.com/ui/account-and-settings/how-to-set-up-domain-authentication

Using dedicated IP addresses for any SendGrid account will build email reputation over time (improving email deliverability). And lastly, to control spoofing, phishing, and spam, it is recommended to set up [SPF](https://docs.sendgrid.com/ui/account-and-settings/spf-records) and [DKIM](https://docs.sendgrid.com/ui/account-and-settings/dkim-records) records for the primary email domain (such as `example-company.com`). Emails should also be sent from an address such as `no-reply@example-company.com`.

### Gmail

Gmail is a commonly used SMTP service. Gmail is not recommended for production use, since it has a [number of limits](https://support.google.com/a/answer/166852). However, it can be useful to test email functionality.

For Gmail, use [application passwords](https://support.google.com/accounts/answer/185833), otherwise you may get a generic `Unable to send email via JavaMail / Prime Messaging Exception` error.

### AWS SES

<strong></strong>
<InlineField></InlineField>

### Brevo (Previously Send In Blue)

### Mailersend

- Create an account at https://app.mailersend.com.
- Browse to [Email -> Domains](https://app.mailersend.com/domains) and click <InlineField>Manage</InlineField> on the trial domain they created for you.
- Under <strong>SMTP</strong>, click <InlineField>Generate new user</InlineField> and then click <InlineField>Manage</InlineField> for the user.
- Copy the values shown for all the fields on this screen to your tenant's email tab in the FusionAuth web interface.
- Leave <InlineField>Security</InlineField> as `TLS`.
- Use a <InlineField>Default from address</InlineField> with your Mailersend trial, such as `fa@trial-o89qngkvfrwlwr32.mlsender.net`.
- Click <InlineField>Send test email</InlineField> to test the settings work, then click the save icon at the top right.

### Mailgun

### Mandrill

### Postmark

### Resend

Resend will allow you to send emails only through a verified domain. You may not send emails through their domain or your localhost.

For an overview of all the records Resend asks you set on your domain, please read their [documenation](https://resend.com/docs/dashboard/domains/introduction).

- Create an account at https://resend.com.
- Browse to https://resend.com/domains
- In your website domain manager, add the records from Resend above. Below is an example using the domain `fusionauth.ddns.net`:
  - If you use cPanel, alter your records at <strong>Domains -> Zone Editor</strong>
  - Add MX Record:
    - Click on “Manage” next to your domain.
    - Select “Add Record” and choose “MX” from the dropdown.
    - Enter the priority (typically 10 for primary MX record).
    - Enter the mail server address provided by your email service (you may find it under “Value” or “Point to” in their setup instructions).
    - Set the TTL (Time to Live) as advised, or use the default (often 14400 seconds or 3600 seconds)
  - Add TXT Records for SPF and DKIM:
    - Again, use “Add Record”.
    - Select “TXT” from the dropdown.
    - Leave the “Name” field blank or enter @ to denote the root domain.
    - For SPF, the value might look something like "v=spf1 include:_spf.example.com ~all" (replace with your specific SPF record details).
    - For DKIM, the value might look something like "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD..."
    - Set the TTL as before.
  - Add TXT Record for DMARC:
    - Use “Add Record”.
    - Select “TXT” from the dropdown.
    - In the “Name” field, enter _dmarc.
    - In the “Value” field, enter your DMARC policy, like "v=DMARC1; p=none; rua=mailto:your@email.com"
    - Set the TTL.
- Browse to https://resend.com/api-keys and create a key with sending access only.
- Browse to https://resend.com/settings/smtp and note your SMTP details.
- In your tenant's email tab in the FusionAuth web interface, set the following values:
  - <InlineField>Host</InlineField>: `smtp.resend.com`
  - <InlineField>Port</InlineField>: `587`
  - <InlineField>Username</InlineField>: `resend`
  - <InlineField>Password</InlineField>: Your API key
  - <InlineField>Security</InlineField>: `TLS`
  - <InlineField>Default from address</InlineField>: `fa@example.com`

```text
Unable to send email via JavaMail

Prime Messaging Exception
450 The resend.com domain is not verified. Please, add and verify your domain on https://resend.com/domains
```

For more information, read the [Resend documentation on SMTP](https://resend.com/docs/send-with-smtp).

## TODO

This shouldn’t actually document the exact steps for each provider (as hopefully they already have that in their own documentation), but we should go through the process for each one, set it up with Fusionauth, link out to them where needed, and make notes about any gotchas or potential problems

Shout on Slack if any don’t have a free plan so we can set up a paid test account. We already have one on AWS, so ask for credentials for that.
Resources
Current docs: https://fusionauth.io/docs/customize/email-and-messages/configure-email#smtp-providers
In GitHub https://github.com/ritza-co/fusionauth-site/blob/master/astro/src/content/docs/customize/email-and-messages/configure-email.mdx

workaddress@simplelogin.com


## Fixing errors

Below are some common errors you might encounter when configuring SMTP and how to fix them.

### Authentication error

```text
Unable to send email via JavaMail

Prime Messaging Exception
535 Authentication failed.
```

This error indicates that your username or password is probably incorrect. Re-enter them carefully with no excess whitespace and try again.


### Socket timeout

```text
Error:

Unable to send email via JavaMail

Prime Messaging Exception
Exception reading response
Cause: SocketTimeoutException: Read timed out
```

You probably need to change the port number. Try `587`.

###

```text
Unable to send email via JavaMail

Prime Messaging Exception
450 The resend.com domain is not verified. Please, add and verify your domain on https://resend.com/domains
```

### FusionAuth says a test email was sent but it doesn't arrive

Try the following:
- Wait longer.
- Check if your SMTP provider received the request.
- Check your spam folder in your email client, or other folders if you have filters enabled.
- Disable webhooks in FusionAuth, in case a failed webhook is causing complications.
<InlineField></InlineField>