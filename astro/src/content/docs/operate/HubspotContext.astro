<script>
  // Function to build hs_context JSON and insert it into the form
  function setHubSpotContext() {
    const hutk = getCookie('hubspotutk'); // Get HubSpot tracking cookie

    const hsContext = {
      hutk: hutk, // Include the tracking cookie
      pageUrl: window.location.href,
      pageName: document.title
    };

    document.getElementById('hs_context').value = JSON.stringify(hsContext);
  }

  // Helper function to read cookies
  function getCookie(name) {
    const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
    return match ? match[2] : null;
  }

  // Attach submit event handler to add hs_context before submission
  document.getElementById('custom-form').addEventListener('submit', function (e) {
    setHubSpotContext();
    // The form will submit normally with hs_context included
  });
</script>
