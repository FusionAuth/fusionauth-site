---
publish_date: 2025-07-23
title: "Multi-Platform Video Uploads: Using Identity Provider Links"
htmlTitle: "Multi-Platform Video Uploads: Using Identity Provider Links"
description: Learn how to build a video upload application that connects to multiple services like Google and Twitter using FusionAuth's Identity Provider Links.
image: /img/blogs/identity-provider-links/identity-provider-links-header.png
authors: Colin Frick, Aaron Ritter
categories: Education
tags: identity provider, social login, google, twitter, links, oauth, video upload, youtube
excerpt_separator: "{/* more */}"
codeRoot: https://raw.githubusercontent.com/sonderformat-llc/fusionauth-example-using-links-fastify/refs/heads/main
---
import Aside from 'src/components/Aside.astro';
import {RemoteCode} from '@fusionauth/astro-components';

In today's content-driven world, a regular requirement is to share content across multiple platforms to maximize reach and engagement. However, managing separate accounts and authentication flows for each platform can be cumbersome. What if you could build an application that allows users to upload videos to both YouTube (Google) and Twitter with a single login? This is where FusionAuth's Identity Provider Links feature becomes invaluable.

Identity Provider (IDP) Links allow you to connect a FusionAuth user account with multiple social identity providers through access and refresh tokens, enabling your application to securely access APIs from different platforms while maintaining a single unified user account.

{/* more */}

## What Are Identity Provider Links?

Identity Provider Links establish a relationship between a FusionAuth user and users in third-party identity providers such as Google and Twitter. When a link is created, FusionAuth stores information about the connection, including:

- The identity provider ID
- The user ID in the identity provider
- The FusionAuth user ID
- A display name (usually an email or username)
- Access or refresh token from the identity provider

This feature enables your application to securely access APIs from different platforms while maintaining a single unified user account.

## Preparation

Before we dive into the implementation, let's set up our environment. We'll need:

1. A running FusionAuth instance
2. Google and Twitter developer accounts with API access
3. A video upload application that connects to multiple services

### Setting Up FusionAuth

If you don't already have FusionAuth running, you can follow [Step-1](/docs/get-started/start-here/step-1) of the [Get Started Tutorial](/docs/get-started/start-here/). Alternatively, check out our [example application on GitHub](https://github.com/sonderformat-llc/fusionauth-example-using-links-fastify) which includes a pre-defined Kickstart configuration.

Once FusionAuth is running, create an application:

1. Log in to the FusionAuth admin UI
2. Navigate to Applications → Add
3. Enter a name for your application (e.g., "Video Upload App")
4. On the OAuth tab, add a Redirect URL (e.g., `http://localhost:3000/auth/callback`)
5. Enable the Authorization Code grant
6. Save the application and note the Client ID and Client Secret

### Creating the Video Upload Application

For our demo, we'll create a Node.js application using Fastify that will:

1. Allow users to log in with FusionAuth
2. Connect to both Google (YouTube) and Twitter accounts
3. Upload videos to multiple platforms simultaneously

The complete application structure is available in our [example repository](https://github.com/sonderformat-llc/fusionauth-example-using-links-fastify).

## Setting Up Identity Providers

Now, let's configure the identity providers we'll be using: Google and Twitter.

### Setting Up OpenID Connect for YouTube API Access

To set up YouTube API access in FusionAuth, we need to use the [OpenID Connect](/docs/apis/identity-providers/openid-connect) identity provider instead of the standard [Google](/docs/apis/identity-providers/google) identity provider.

<Aside type="caution">
The standard Google identity provider in FusionAuth stores an id_token in the identityProviderLink object that cannot be used for API access. For YouTube API integration, you must use the OpenID Connect identity provider configured for Google.
</Aside>

The key difference is that the OpenID Connect identity provider can be configured to request and store a refresh token, which can be exchanged for access tokens to make API calls to YouTube.

#### Enabling the YouTube Data API

Before you can upload videos to YouTube, you need to enable the YouTube Data API in your Google Cloud project:

1. Go to the [Google Cloud Console](https://console.cloud.google.com)
2. Create a new project or select an existing one
3. Navigate to APIs & Services → Library
4. Search for "YouTube Data API v3" and enable it

#### Creating an Application in Google Cloud

After enabling the YouTube Data API, you need to create an OAuth application in Google Cloud:

1. In the Google Cloud Console, navigate to APIs & Services → OAuth consent screen
2. Select "External" as the user type (unless you have a Google Workspace)
3. Fill in the required information:
   - App name (e.g., "Video Upload App")
   - User support email
   - Developer contact information
4. Click "Save and Continue"
5. On the Scopes screen, add the following scopes:
   - `https://www.googleapis.com/auth/youtube.upload`
   - `https://www.googleapis.com/auth/youtube`
   - `https://www.googleapis.com/auth/youtube.readonly`
6. Click "Save and Continue"
7. Add test users if you're not verifying your app
8. Click "Save and Continue" to complete the setup

#### Creating Google OAuth 2.0 Credentials with YouTube Scopes

Now you need to create OAuth 2.0 credentials that your application will use to authenticate with Google:

1. In the Google Cloud Console, navigate to APIs & Services → Credentials
2. Click "Create Credentials" and select "OAuth client ID"
3. Select "Web application" as the application type
4. Enter a name for your client (e.g., "Video Upload Client")
5. Add authorized JavaScript origins:
   - `http://localhost:3000` (for development)
6. Add authorized redirect URIs:
   - `http://localhost:9011/oauth2/callback` (for FusionAuth)
   - `http://localhost:3000/auth/callback` (for your application)
7. Click "Create"
8. Note the Client ID and Client Secret that are generated

When configuring scopes in the consent screen, make sure you've included the following for YouTube uploads:
- `https://www.googleapis.com/auth/youtube.upload` - Required for uploading videos
- `https://www.googleapis.com/auth/youtube` - Full access to YouTube account
- `https://www.googleapis.com/auth/youtube.readonly` - Read-only access for metrics
- `email profile openid` - Standard user information

#### Configuring the OpenID Connect Identity Provider for Google in FusionAuth

Now that you have your Google OAuth credentials, you need to configure an OpenID Connect identity provider in FusionAuth:

1. In FusionAuth, go to Settings → Identity Providers
2. Click "Add OpenID Connect"
3. Enter a name like "Google YouTube API"
4. Enter the Client ID and Client Secret from Google
5. Set the following endpoints:
   - Authorization endpoint: `https://accounts.google.com/o/oauth2/v2/auth`
   - Token endpoint: `https://oauth2.googleapis.com/token`
   - Userinfo endpoint: `https://openidconnect.googleapis.com/v1/userinfo`
6. Set "Discover endpoints" to "No" since we're manually entering them
7. In the scope field, add: `email profile openid https://www.googleapis.com/auth/youtube.upload https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.readonly`
8. Set the button text to "Login with Google for YouTube"
9. Select the applications that should use this identity provider

<Aside type="note">
For YouTube API access, you'll need to ensure your Google Cloud project has been verified by Google if you plan to publish your application. During development, you can test with unverified apps, but they have limitations on the number of users.
</Aside>

### Setting Up Twitter as an Identity Provider

To set up Twitter as an identity provider with media upload capabilities:

1. Create a Twitter developer account
2. Apply for Elevated access (required for media uploads)
3. Create a Twitter app with appropriate permissions
4. Configure the authentication settings
5. Create a Twitter Identity Provider in FusionAuth

For detailed instructions on the basic setup, refer to the [Twitter Identity Provider documentation](https://fusionauth.io/docs/lifecycle/authenticate-users/identity-providers/social/twitter).

#### Applying for Elevated Access

Twitter's standard API access doesn't allow for media uploads. You'll need to apply for Elevated access:

1. Go to the [Twitter Developer Portal](https://developer.twitter.com)
2. Navigate to the Projects & Apps section
3. Apply for Elevated access by clicking on "Apply for Elevated" 
4. Complete the application form, explaining your use case for media uploads
5. Wait for approval (this can take a few days)

#### Creating a Twitter App with Media Upload Permissions

Once you have Elevated access, you need to create a Twitter app with the appropriate permissions:

1. In the Twitter Developer Portal, create a new app (e.g., "Video Upload App")
2. Under "App permissions", select "Read and Write" (required for media uploads)
3. Under "Authentication settings", enable "3-legged OAuth"
4. Add a callback URL: `http://localhost:9011/oauth2/callback`
5. Enable "Request email from users"
6. Note the API Key and API Secret Key

#### Configuring the Twitter Identity Provider in FusionAuth

Now you need to configure the Twitter identity provider in FusionAuth:

1. In FusionAuth, go to Settings → Identity Providers
2. Click "Add Twitter"
3. Enter the Consumer Key (API Key) and Consumer Secret (API Secret Key)
4. Configure the button text (e.g., "Login with Twitter")
5. Select the applications that should use this identity provider

<Aside type="caution">
  Twitter has rate limits for media uploads. For production applications, you'll need to implement appropriate rate limiting and error handling.
</Aside>

## Using Identity Provider Links

Now that we have our identity providers set up, let's explore how to use the Identity Provider Links API.

### Understanding Token Storage in Identity Provider Links

When working with Identity Provider Links for API access, different identity providers store tokens differently:

- The OpenID Connect identity provider configured for Google stores a **refresh_token** that can be exchanged for access tokens
- Twitter stores access token and secret information that can be parsed for API access

When implementing API access using Identity Provider Links, you need to:

1. Configure the appropriate identity provider
2. Extract the token from the identityProviderLink object
3. For Google/YouTube, exchange the refresh token for an access token before making API calls
4. For Twitter, parse the token string to extract the access token and secret

### The Links API

FusionAuth provides a comprehensive API for managing identity provider links:

1. **Retrieve Links** - Get all identity provider links for a user
```
GET /api/identity-provider/link?userId=<userId>
```

2. **Create a Link** - Link a user to an identity provider
```
POST /api/identity-provider/link
```

3. **Delete a Link** - Remove a link between a user and an identity provider
```
DELETE /api/identity-provider/link?identityProviderId=<identityProviderId>&identityProviderUserId=<identityProviderUserId>&userId=<userId>
```

In our Fastify application, we've implemented these API calls to enable the following functionality:

1. **Link a User**: Create a link between a FusionAuth user and a social identity
2. **Retrieve Links**: Get information about existing links to determine available upload platforms
3. **Unlink a User**: Remove a link between a FusionAuth user and a social identity

Let's look at how to use these endpoints in our application.

### Implementing Video Uploads with Identity Provider Links

Let's implement our video upload application with identity provider links using Fastify. We'll focus on the key components that handle the upload process.

First, let's look at the main application structure:

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/app.ts"} lang="typescript"/>

Next, let's examine how we retrieve the user's identity provider links:

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/env.ts"} lang="typescript"/>

Let's create the service files for interacting with YouTube and Twitter:

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/links/youtube.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/links/twitter.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/fusionauth.ts"} lang="typescript"/>

Now, let's implement the routes for our application:

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/routes/root.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/routes/auth.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/routes/links.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/routes/upload.ts"} lang="typescript"/>

Finally, let's implement the routes for linking new providers:

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/links/index.ts"} lang="typescript"/>

<RemoteCode url={frontmatter.codeRoot + "/complete-application/src/utils.ts"} lang="typescript"/>

### Testing the Implementation

To test our implementation:

1. Clone the example repository: `git clone https://github.com/sonderformat-llc/fusionauth-example-using-links-fastify`
2. Install dependencies: `npm install`
3. Create a `.env` file with your configuration
4. Start the application: `npm run dev`
5. Navigate to `http://localhost:3000` in your browser
6. Log in with your FusionAuth credentials
7. Link your Google and Twitter accounts
8. Upload a video file and select which platforms to post to
9. View the results showing links to your uploaded content

## Conclusion

Identity Provider Links are a powerful feature of FusionAuth that enable you to build sophisticated multi-platform applications like our video uploader. By connecting multiple social identities to a single user account, you can provide a seamless experience for content creators.

The example application demonstrates several key concepts:

- **Single Sign-On with Multiple Providers**: Users can log in once with FusionAuth and access multiple platforms
- **Token Management**: The application securely stores and uses tokens for API access
- **Cross-Platform Publishing**: Videos can be uploaded to multiple platforms with a single action
- **User Experience**: The interface allows users to easily manage their connected accounts

By leveraging Identity Provider Links, you can create a unified video publishing experience that simplifies the workflow for content creators. This approach opens up possibilities for more advanced features like:

- Consolidated analytics dashboards showing performance across platforms
- Synchronized comment moderation across YouTube and Twitter
- Coordinated publishing schedules and content strategies
- Backup options if one platform experiences issues

The complete source code for this example is available on [GitHub](https://github.com/sonderformat-llc/fusionauth-example-using-links-fastify), allowing you to explore the implementation details and adapt it to your own applications.

For more information, check out the [FusionAuth documentation on Identity Provider Links](https://fusionauth.io/docs/apis/identity-providers/links) and the guides for setting up [Google](https://fusionauth.io/docs/lifecycle/authenticate-users/identity-providers/social/google) and [Twitter](https://fusionauth.io/docs/lifecycle/authenticate-users/identity-providers/social/twitter) identity providers.
