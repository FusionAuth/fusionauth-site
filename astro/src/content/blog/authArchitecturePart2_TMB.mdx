# Part 2 of 3 on authentication architecture: the token-mediating backend (TMB)

## Introduction

- This is part two of three part post, which discusses the TMB.
- Please read part one before continuing.

## What is a Token-Mediating Backend?
- Identical to BFF in part 1, except access token stored in frontend (mobile, desktop, or web) and frontend calls resource server/API directly.
- Link to OAuth2 TMB spec

## How secure is a TMB?
- Massively less secure than BFF in part 1, as tokens are stored in browser localStorage and thus vulnerable to malicious JS.
- Massively more secure than serverless app in part 3.
- Protected from cross site attacks.
- Successful attacks are short-lived if you follow best practices (link to OAuth 2.1 draft and explain, with summary link to https://maida.kim/oauth2-best-practices-for-developers), which include short timeouts on tokens.

## When to use a TMB?
- Only if you cannot, or may not, call a resource server through a proxy (backend) server and must call it through the frontend directly. (Can't think of an example of this, I must go find or LLM one)
- Aside, FA uses BFF by default, with easy to use hosted backend; perhaps with link to first articleâ€™s section on BFF-HB benefits
- Even if your auth provider SDK doesn't provide a hosted backend it's still trivial to create a BFF in a tiny page of JS (see my article here https://fusionauth.io/blog/backend-for-frontend#how-to-create-a-bff-for-a-serverless-app and code here https://github.com/FusionAuth/fusionauth-example-hostedbackend/blob/main/nodeApp/app.js)

## Getting technical: how the TMB flow works
- This section explains the TMB oauth flow
- You can skip it and proceed to the demo in the next section if you don't need to implement or understand the details yourself
- First review the BFF flow in part 1
- Explain the differences with an example login and resource call, include a diagram
- Note potential attacks

## Code demonstration
- The section will allow you to run a simple but functional TMB web app and server with FA to see how it works
### Prerequisites
- Docker, Node/Bun/Deno
### Run the app
- Download, configure, run, login, usernames and passwords, screenshots
### How it works
- Briefly describe what's in each file

## Summary
- Briefly repeat the 'when to use section' because of the 'how secure' section.
- Link to FA hosted backend

## Read part 3
- Brief description of what's in that article

---

# Questions for Kim
- Do we want to include competitor review table in part 3? Might be nice to advertise FA advantages. If so, might be good to include Ory Kratos/Hydra - it's the only truly free and open source alternative to Keycloak I found (unlike FA which is freemium) that seems to be a bit more powerful than Keycloak, so people would probably want to compare it.
- I have the same question as Zoe in your presentation. I didn't understand the answer given. BFF started as team organisation and efficiency thing (like microservices) but is now conflated with a security pattern. The BFF security pattern could more simply be called "not serverless pattern" or "backend tokens pattern". So I don't understand why we need to keep the original BFF pattern aim of one server per frontend. How does having only one server for multiple frontends negatively impact security?
- Outer Wilds stickers! Very cool