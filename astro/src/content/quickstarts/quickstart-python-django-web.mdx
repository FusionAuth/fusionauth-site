---
title: Python Django
description: Quickstart integration of Python Django web application with FusionAuth
navcategory: getting-started
prerequisites: Python 3.8 and pip3
section: web
technology: Django
language: Python
icon: /img/icons/python.svg
faIcon: fa-snake
color: yellow
cta: EmailListCTA
---
import Aside from '/src/components/Aside.astro';
import LoginAfter from '../../diagrams/quickstarts/login-after.astro';
import LoginBefore from '../../diagrams/quickstarts/login-before.astro';
import RemoteCode from '/src/components/RemoteCode.astro';

In this quickstart you are going to build an application with Python and Django, and integrate it with FusionAuth.
You'll be building it for [ChangeBank](https://www.youtube.com/watch?v=pkH-kD73QUM), a global leader in converting dollars into coins.
It'll have areas reserved for users who have logged in as well as public facing sections.

The docker compose file and source code for a complete application are available at
https://github.com/RichardJECooke/fusionauth-quickstart-python-django-web/.

## Prerequisites
For this Quickstart, you'll need:
* [Python3.8](https://www.python.org/downloads/) or later.
* [Docker](https://www.docker.com): The quickest way to start FusionAuth. (There are [other ways](https://fusionauth.io/docs/v1/tech/installation-guide/)).

## General Architecture

While this sample application doesn't have login functionality without FusionAuth, a more typical integration will replace an existing login system with FusionAuth.

In that case, the system might look like this before FusionAuth is introduced.

<LoginBefore alt={"Request flow during login before FusionAuth"}/>

The login flow will look like this after FusionAuth is introduced.

<LoginAfter alt={"Request flow during login after FusionAuth"}/>

In general, you are introducing FusionAuth in order to normalize and consolidate user data. This helps make sure it is consistent and up-to-date as well as offloading your login security and functionality to FusionAuth.

## Getting Started
In this section, you'll get FusionAuth up and running and use Django to create a new application.

### Clone the Code
First off, grab the code from the repository and change into that directory.

```
git clone https://github.com/RichardJECooke/fusionauth-quickstart-python-django-web.git
cd fusionauth-quickstart-python-django-web
```

### Run FusionAuth via Docker
In the root directory of the repo you'll find a Docker compose file (docker-compose.yml) and an environment
variables configuration file (.env). Assuming you have Docker installed on your machine, you can stand up
FusionAuth up on your machine with:

```
docker-compose up -d;
```

This will start three containers, once each for FusionAuth, Postgres, and Elastic.

Here you are using a bootstrapping feature of FusionAuth, called [Kickstart](/docs/v1/tech/installation-guide/kickstart).
When FusionAuth comes up for the first time, it will look at the `kickstart/kickstart.json` file and
configure FusionAuth to a certain initial state.

<Aside type="note">
If you ever want to reset the FusionAuth system, delete the volumes created by docker-compose by
executing `docker-compose down -v`, then re-run `docker-compose up -d`.
</Aside>

FusionAuth will be configured with these settings
* Your client Id is `e9fdb985-9173-4e01-9d73-ac2d60d1dc8e`.
* Your client secret is `super-secret-secret-that-should-be-regenerated-for-production`.
* Your example username is `richard@example.com` and the password is `password`.
* Your admin username is `admin@example.com` and the password is `password`.
* The base URL of FusionAuth `http://localhost:9011/`.

You can log into the [FusionAuth admin UI](http://localhost:9011/admin) and look around if you want, but with Docker/Kickstart you don't need to.

### Create a Basic Django Application
In this section, you'll set up a basic Django application with a single page. While this section builds a simple
Python / Django application, you can use the same method to integrate your existing application with FusionAuth.

#### Setup Your Environment
We recommend working in a virtual environment for this.

```shell
python3.8 -m venv venv && source venv/bin/activate
```

Next, create a requirements.txt file to name the project dependencies. (All the files in this guide already exist in the `complete-application` folder if you want to copy them.)

`requirements.txt`
<RemoteCode url="https://raw.githubusercontent.com/RichardJECooke/fusionauth-quickstart-python-django-web/main/complete-application/requirements.txt"
 lang="python" />

And then install the dependencies into your virtual env.

```shell
pip install -r complete-application/requirements.txt
```

#### Create the Application
 Now create your Django app.{/*, which for now will consist of an environment file named `.env` and a python file named `server.py`. */}

{/* Create the environment file with these contents:

`.env`
<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/.env"
 lang="shell" /> */}

```shell
django-admin startproject mysite
```

Then, start your server:

```shell
python mysite/manage.py runserver
```

You can [visit it](http://localhost:8000) to ensure it is running. If you need to stop it, hit `control-C` to do so. You can leave this running while you build your application so that you can see your progress.

### Create a View
Open a new terminal. It is going to be easier to run commands from within your `mysite` directory, so `cd` into it:

```shell
source venv/bin/activate;
cd mysite
```

Create an app within your `mysite` project:

```shell
python manage.py startapp app
```

If you visit [http://localhost:8000/app](http://localhost:8000/app) you'll see an error message because you need to create a view. Make a `templates` directory.

```shell
mkdir -p app/templates/app
```

And paste this HTML into the `app/templates/app/authentication.html` file:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Django OAuth App</title>
</head>
<body>
<div>
Hello!
</div>
</body>
</html>
```

Create a `urls.py` file for your application, at `app/urls.py`, and put the following text in it:

{/* TODO RemoteCode */}
```python
from django.urls import path

from . import views

urlpatterns = [
    path('', views.index, name='index'),
]
```

Then you have to tie the view to the template you created above by modifying `app/views.py` to look like:

{/* TODO RemoteCode */}
```python
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/add-first-page/mysite/app/views.py[]
```

Then, modify `mysite/settings.py`. First, import the `os` module, changing the imports at the top of `mysite/settings.py` to look like:

```python
import os
from pathlib import Path
```

Then, add `'app`' to your list of installed applications. Add it to the `INSTALLED_APPS` array.

```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'app',
]
```

The last change with `mysite/settings.py` is to update the templates variable. Look for the `TEMPLATES` variable and replace the `DIRS` field with this:

```python
'DIRS': (os.path.join(BASE_DIR, 'polls/templates'),),
```

Finally you have to edit the `mysite/urls.py` file:

* Add `path('app/', include('app.urls')),` to the `urlpatterns` variable in that file.
* Change the import line: `from django.urls import path` to `from django.urls import include, path`.

Here's what `mysite/urls.py` should look like:

{/* TODO RemoteCode */}
```python
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/add-first-page/mysite/mysite/urls.py[]
```

At this point, you can visit http://localhost:8000/app[http://localhost:8000/app] and you should be greeted with the contents of the `authentication.html` file you created above.


=== Add Authentication

Now you are going to link up FusionAuth and add authentication to this project.

First, modify `mysite/settings.py` and add `mozilla_django_oidc` to the list of applications. You installed this app in your environment when you updated `requirements.txt`.

{/* TODO RemoteCode */}
```python
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/main/mysite/mysite/settings.py[tags=installedApps]
```

You need to add some additional configuration for this app. Just below the `INSTALLED_APPS` array, add this:

{/* TODO RemoteCode */}
```python
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/main/mysite/mysite/settings.py[tags=oidcConfig]
```

Save the `mysite/settings.py` file.

Next, update the paths to include those provided by the mozilla_django_oidc code. Here's what `mysite/urls.py` should look like:

{/* TODO RemoteCode */}
```python
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/main/mysite/mysite/urls.py[]
```

Then you want to update the `app/templates/app/authentication.html` file to have this content:

{/* TODO RemoteCode */}
```html
{% raw %}
include::https://raw.githubusercontent.com/FusionAuth/fusionauth-example-python-django-guide/main/mysite/app/templates/app/authentication.html[]
{% endraw %}
```

Run all your migrations to make sure you have any needed database tables set up.

```bash
python manage.py migrate
```

== Testing the Authentication Flow

You can now open up an incognito window and visit http://localhost:8000/app[the Django app].
Log in using the user you added in FusionAuth, and you'll see a welcoming message.

{/* COPIED FLASK STUFF: */}
{/*
In server.py, you'll add all of the imports you'll need, declare some constants, and initialize the OAuth library.

`server.py`
<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="baseApplication"/>

<Aside type="tip">
You should be able to start your Flask application with `flask --app server.py --debug run`.
Note that you won't be able to access it with a browser yet!
</Aside>

#### Create a Home Route and a Home Page
The next step is to get a basic home page up and running. This will require a back end route to handle requests to `/` and a web page template.

In the route function, you're going to look for an access token, which is created when a user is successfully authenticated. If the user
is not authenticated, you'll just take them to the home page. However, if they _are_ authenticated, you'll redirect them to
an `/account` page. Since we haven't implemented login yet, the redirect to `/account` won't work.

Add the route handling function to your server.py file.

`server.py`
<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="homeRoute"/>

Next, create the home page in a `templates` directory. This page just has a login button, which won't do anything yet. These commands also
install a CSS file and an image to make your app look nicer.

```shell
mkdir -p templates static/css static/img && \
wget -O templates/home.html https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/templates/home.html && \
wget -O static/css/changebank.css https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/static/css/changebank.css && \
wget -O static/img/money.jpg https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/static/img/money.jpg

```

<Aside type="tip">
With the home page and route complete, you can view the home page in your brower at `http://localhost:5000`.
</Aside>

## Authentication
In this section you'll build the integration with FusionAuth, which will allow users to log in to your application.

### Add OAuth Authentication Routes
Next, you'll add a `/login` route that uses authlib to take the user to FusionAuth's OAuth2 `authorize` endpoint,
and a `/callback` route that FusionAuth will redirect the user back to after a successful login.

FusionAuth will include an authorization code in the redirect to `/callback`, and the callback function will
make a server-to-server call to FusionAuth to exchange the authorization code for an access token, refresh token,
and userinfo object. All of this happens in `oauth.FusionAuth.authorize_access_token()`. This sequence of redirects and
back end calls is known as an OAuth Authorization Code Grant flow.

After your app gets the information back from FusionAuth, you'll write these items to HTTP-only cookies, so that they will
be returned to the Flask application on subsequent requests, but are not readable by code running in the browser.

We also set the userinfo object in the Flask session, to make it easy to use in rendered templates.

Add the `/login` and `/callback` routes to your server code.

`server.py`
<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="loginRoute"/>

<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="callbackRoute"/>

<Aside type="tip">
Once these steps are done, you should be able to successfully log into your application! Just note that after logging
in, you're taking the user to `/account`, which doesn't exist yet.
</Aside>

### Add a Secured Page
Remember that after logging in, the application redirects the user to `/`, which then redirects a
logged in user to '/account'. You going to add that route and page now.

First, create the page template for a logged-in user. It's going to show a personalized header
and a logout button.

```shell
wget -O templates/account.html https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/templates/account.html
```

Next, create a route to get to that page. This checks if an access token is present.
If one isn't, it forces a logout at FusionAuth. If one is, it renders the `/account` page.

<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="accountRoute"/>

<Aside type="tip">
Now when you log in, you should see the `/account` page!
</Aside>

### Add Logout Support
The last step is to implement logout. When you log a user out of an application, you'll take them to
FusionAuth's `/oauth2/logout` endpoint. After logging the user out, FusionAuth will redirect the user
to your app's `/login` endpoint, which you'll create now. This endpoint deletes any cookies that your
application created, and clears the Flask session.

<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-quickstart-python-flask-web/main/complete-application/server.py"
 lang="python"
 tags="logoutRoute"/>

<Aside type="tip">
Click the `Logout` button and watch the browser first go to FusionAuth to log out the user, then return to your home page.
</Aside>

## Next Steps
This quickstart is a great way to get a proof of concept up and running quickly, but to run
you application in production, there are some things you're going to want to do.

### FusionAuth Customization
FusionAuth gives you the ability to customize just about everything with the user's experience and your application's integration. This includes
* [Hosted pages](https://fusionauth.io/docs/v1/tech/themes/) such as login, registration, email verification, and many more
* [Email templates](https://fusionauth.io/docs/v1/tech/email-templates/email-templates)
* [User data and custom claims in access token JWTs](https://fusionauth.io/articles/tokens/jwt-components-explained)

### Security
* You may want to customize the [token expiration times and policies](https://fusionauth.io/docs/v1/tech/oauth/#configure-application-oauth-settings) in FusionAuth
* Choose [password rules](https://fusionauth.io/docs/v1/tech/core-concepts/tenants#password) and a [hashing algorithm](https://fusionauth.io/docs/v1/tech/reference/password-hashes) that meet your security needs

### Tenant and Application Management
* Model your application topology using [Applications](https://fusionauth.io/docs/v1/tech/core-concepts/applications), [Roles](https://fusionauth.io/docs/v1/tech/core-concepts/roles), [Groups](https://fusionauth.io/docs/v1/tech/core-concepts/groups), [Entities](https://fusionauth.io/docs/v1/tech/core-concepts/groups), and more
* Set up [MFA](https://fusionauth.io/docs/v1/tech/guides/multi-factor-authentication), [Social login](https://fusionauth.io/docs/v1/tech/identity-providers/), and/or [SAML](https://fusionauth.io/docs/v1/tech/identity-providers/samlv2/) integrations
* Integrate with external systems using [Webhooks](https://fusionauth.io/docs/v1/tech/events-webhooks/), [SCIM](https://fusionauth.io/docs/v1/tech/core-concepts/scim), and [Lambdas](https://fusionauth.io/docs/v1/tech/lambdas/) */}
