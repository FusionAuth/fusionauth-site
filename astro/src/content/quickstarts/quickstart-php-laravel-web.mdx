---
title: Laravel
description: Quickstart integration of PHP Laravel web application with FusionAuth
navcategory: getting-started
prerequisites: Docker version 20
section: web
cta: EmailListCTA
technology: Laravel
language: PHP
icon: /img/icons/laravel.svg
faIcon: fa-laravel
url: https://github.com/ritza-co/fusionauth-quickstart-php-laravel-web
codeRoot: https://raw.githubusercontent.com/ritza-co/fusionauth-quickstart-php-laravel-web/main
---

import Aside from '/src/components/Aside.astro';
import Breadcrumb from '/src/components/Breadcrumb.astro';
import Field from '/src/components/Field.astro';
import LoginAfter from '../../diagrams/quickstarts/login-after.astro';
import LoginBefore from '../../diagrams/quickstarts/login-before.astro';
import RemoteCode from '/src/components/RemoteCode.astro';
import Uielement from '/src/components/Uielement.astro';

In this quickstart, you will build an application with {frontmatter.technology} and integrate it with FusionAuth. The application is for [ChangeBank](https://www.youtube.com/watch?v=pkH-kD73QUM), a global leader in converting dollars into coins. It will have areas reserved for logged in users and public-facing sections.

Find the Docker Compose file and source code for the complete application at <a href={frontmatter.url}>{frontmatter.url}</a>.

## Prerequisites

For this Quickstart, you'll need:

* [Docker](https://www.docker.com), version 20 or later, which is the quickest way to start FusionAuth. (There are [other ways](/docs/v1/tech/installation-guide/)).

## General Architecture

While this sample application doesn't have login functionality without FusionAuth, a more typical integration will replace an existing login system with FusionAuth.

In that case, the system might look like this before FusionAuth is introduced.

<LoginBefore alt={"Request flow during login before FusionAuth"}/>

The login flow will look like this after FusionAuth is introduced.

<LoginAfter alt={"Request flow during login after FusionAuth"}/>

In general, you would introduce FusionAuth to normalize and consolidate user data, making it consistent and up-to-date and offloading your login security and functionality to FusionAuth.

## Getting Started

Start with getting FusionAuth up and running and creating a new {frontmatter.technology} application.

### Clone The Code

First, grab the code from the repository and change into that folder.

```
git clone https://github.com/ritza-co/fusionauth-quickstart-php-laravel-web
cd fusionauth-quickstart-php-laravel-web
```

All shell commands in this guide can be entered in a terminal in this folder. On Windows, you need to replace forward slashes with backslashes in paths.

All the files you'll create in this guide already exist in the `complete-application` subfolder, if you prefer to copy them.

### Run FusionAuth and {frontmatter.technology} Via Docker

You'll find a Docker Compose file `docker-compose.yml` and an environment variables configuration file `.env` in the root folder of the repository.

Assuming you have Docker installed on your machine, you can start FusionAuth on your machine with the following.

```
docker-compose up -d
```

This will start five containers, one each for FusionAuth, Postgres, Elasticsearch, MariaDB, and {frontmatter.technology}.

Here you are using a bootstrapping feature of FusionAuth, called [Kickstart](/docs/v1/tech/installation-guide/kickstart). When FusionAuth starts for the first time, it will look at the `kickstart/kickstart.json` file and configure FusionAuth to your specified state.

<Aside type="note">
If you ever want to reset the FusionAuth system, delete the volumes created by `docker-compose` by executing `docker-compose down -v`, then rerun `docker-compose up -d`.
</Aside>

FusionAuth will be configured with these settings:

* Your client Id is `e9fdb985-9173-4e01-9d73-ac2d60d1dc8e`.
* Your client secret is `super-secret-secret-that-should-be-regenerated-for-production`.
* Your example username is `richard@example.com` and the password is `password`.
* Your admin username is `admin@example.com` and the password is `password`.
* The base URL of FusionAuth is `http://localhost:9011/`.

You can log in to the [FusionAuth admin UI](http://localhost:9011/admin) and look around if you want to, but with Docker and Kickstart, everything will already be configured correctly.

<Aside type="caution">
  The `.env` and `kickstart.json` files contain passwords. In a real application, always add these files to your `.gitignore` file and never commit secrets to version control.
</Aside>

### The Basic {frontmatter.technology} Application

While this guide builds a new {frontmatter.technology} project, you can use the same method to integrate your existing project with FusionAuth.

The {frontmatter.technology} [documentation](https://laravel.com/docs/10.x#your-first-laravel-project) suggests many ways of creating a new project. In this guide, you've used the standard [Bitnami Laravel Docker image](https://hub.docker.com/r/bitnami/laravel), which has created the project for you. If you browse to [http://localhost:3000](http://localhost:3000), you'll see the site is running. This image also contains a version of PHP, so you don't need to install PHP on your physical machine.

All the starter app files are available in the `your-application` folder for editing, mapped to the {frontmatter.technology} Docker volume. Composer packages are already in the `vendor` folder — you don't need to download them. Normally you should not commit your vendor folder to git, but the Docker container won't start without all its Composer dependencies, so they have been included in this guide.

## Authentication

Authentication in {frontmatter.technology} is managed by [Socialite](https://laravel.com/docs/10.x/socialite). For this application, you need the [FusionAuth provider](https://github.com/SocialiteProviders/FusionAuth). To install it, run the following command, which uses the PHP inside your Docker container.

```bash
docker compose exec lara_app      composer require socialiteproviders/fusionauth
```

Edit `your-application/.env` and insert the following lines.

```env
FUSIONAUTH_CLIENT_ID="E9FDB985-9173-4E01-9D73-AC2D60D1DC8E"
FUSIONAUTH_CLIENT_SECRET="super-secret-secret-that-should-be-regenerated-for-production"
FUSIONAUTH_BASE_URL="http://fusionauth:9011"
FUSIONAUTH_REDIRECT_URL="http://localhost:3000/auth/callback"
# FUSIONAUTH_TENANT_ID=
```

This tells {frontmatter.technology} where to find, and connect to, FusionAuth.

In this file, also overwrite the following database fields.

```env
DB_HOST=mariadb
DB_USERNAME=bn_myapp
DB_DATABASE=bitnami_myapp
```

This enables {frontmatter.technology} to connect to the database running in the adjacent Docker container.

<Aside type="note">
  Note that {frontmatter.technology} will silently overwrite the `DB_HOST` value with `mariadb`, in the file `InteractsWithDockerComposeServices.php`, so you can't change this value, or the database service name, in Docker. If you encounter database connection errors in your own apps running in Docker, check that this file isn't interfering with your connection strings.
</Aside>

In the file `your-application/config/services.php`, add one more item to the array being returned with the code below.

<RemoteCode
  url={frontmatter.codeRoot + "/complete-application/laravel/config/services.php"}
  lang="php"
  tags="fusionauth" />

Now the configuration files have all the settings you need. Next, you'll change your provider to be aware of FusionAuth.

In the file `your-application/app/Providers/EventServiceProvider.php`, replace the `$listen` array with the code below.

<RemoteCode
  url={frontmatter.codeRoot + "/complete-application/laravel/app/Providers/EventServiceProvider.php"}
  lang="php"
  tags="fusionauth" />

Finally, you have to update your User model to have FusionAuth fields.

In the file `your-application/app/Models/User.php`, add the FusionAuth items to the `$fillable` and `$hidden` properties with the code below.

<RemoteCode
  url={frontmatter.codeRoot + "/complete-application/laravel/app/Models/User.php"}
  lang="php"
  tags="fusionauth" />

Every model in {frontmatter.technology} has to use the database. You must therefore update the database table to match your new model.

Create a file named `your-application/database/migrations/2023_09_27_142009_add_fusionauth_fields_user_table.php`, or run the command below to create it.

```bash
docker compose exec lara_app        php artisan make:migration add_fusionauth_fields_user_table
```

There is no difference in result if you create the database scripts manually, or with this command. Choose the method you prefer.

Add the code below to the file.

<RemoteCode
  url={frontmatter.codeRoot + "/complete-application/laravel/database/migrations/2023_09_27_142009_add_fusionauth_fields_user_table.php"}
  lang="php" />

Run the command below to update your MariaDB database with the new User definition.

```bash
docker compose exec lara_app         php artisan migrate
```

## Customization

Now that authentication is done, the last task is to create example pages that a user can access only when logged in.

### CSS And HTML

Copy over some CSS and an image from the example app.

```bash
cp ./complete-application/laravel/public/changebank.css ./your-application/public/changebank.css
cp ./complete-application/laravel/public/money.jpg ./your-application/public/money.jpg
```

And copy the three HTML pages from the complete-application.

```bash
cp ./complete-application/laravel/resources/views/index.blade.php ./your-application/resources/views/index.blade.php
cp ./complete-application/laravel/resources/views/account.blade.php ./your-application/resources/views/account.blade.php
cp ./complete-application/laravel/resources/views/change.blade.php ./your-application/resources/views/change.blade.php
```

The index page has nothing interesting except a link to the login page: `<a href="/login">`.

The account page displays the user's email from FusionAuth, as you'll see later when creating the route: `<p class="header-email">{{$email}}</p>`.

The change page uses some Blade conditional statements to display different divs depending on the state returned by the form POST: `@if ($state['error'] && $state['hasChange'])`.

It also includes a `@csrf` anti-forgery token inside the form at the bottom to prevent {frontmatter.technology} throwing page expired errors.

### Route

In the file `your-application/routes/web.php`, overwrite everything with the code below.

<RemoteCode
  url={frontmatter.codeRoot + "/complete-application/laravel/routes/web.php"}
  lang="php" />

The homepage route, `/`, checks if you are logged in, and if so, redirects you to your account page.

The login route replaces the Docker service name, `fusionauth`, with `localhost` in `$url = str_replace('fusionauth', 'localhost', $url);`. The former is used in the {frontmatter.technology} service to access FusionAuth, while the latter needs to be displayed in your browser's URL bar, which doesn't know about Docker since it's on your physical machine. In future apps, if you aren't running in Docker, you can use the first, commented, line instead of this replacement.

After login, FusionAuth redirects you to the `/auth/callback` route. You use Socialite to update the user model in the database, `$user = User::updateOrCreate([`, and then start a session for the user, `Auth::login($user);`.

Logout ends the session with `Auth::logout();`.

The account and change routes both include the user's email in the page template data, `return view('account', ['email' => Auth::user()->email]);`. And both use middleware to prevent users without a session from seeing the page, `})->middleware('auth');`.

Finally, the change route has both a GET and a POST version. They both return the same view, but the POST route does a calculation and includes more template data.

## Run The Application

Browse to [the app](http://localhost:3000). Log in using `richard@example.com` and `password`. The change page will allow you to enter a number. Log out and verify that you can't browse to the [account page](http://localhost:3000/account).

## Next Steps

This quickstart is a great way to get a proof of concept up and running quickly, but to run your application in production, there are some things you're going to want to do.

### FusionAuth Customization

FusionAuth gives you the ability to customize just about everything to do with the user's experience and the integration of your application. This includes:
* [Hosted pages](/docs/v1/tech/themes/) such as login, registration, email verification, and many more.
* [Email templates](/docs/v1/tech/email-templates/email-templates).
* [User data and custom claims in access token JWTs](/articles/tokens/jwt-components-explained).

### Security

* You may want to customize the [token expiration times and policies](/docs/v1/tech/oauth/#configure-application-oauth-settings) in FusionAuth.
* Choose [password rules](/docs/v1/tech/core-concepts/tenants#password) and a [hashing algorithm](/docs/v1/tech/reference/password-hashes) that meet your security needs.

### Tenant And Application Management

* Model your application topology using [Applications](/docs/v1/tech/core-concepts/applications), [Roles](/docs/v1/tech/core-concepts/roles), [Groups](/docs/v1/tech/core-concepts/groups), [Entities](/docs/v1/tech/core-concepts/groups), and more.
* Set up [MFA](/docs/v1/tech/guides/multi-factor-authentication), [Social login](/docs/v1/tech/identity-providers/), or [SAML](/docs/v1/tech/identity-providers/samlv2/) integrations.
* Integrate with external systems using [Webhooks](/docs/v1/tech/events-webhooks/), [SCIM](/docs/v1/tech/core-concepts/scim), and [Lambdas](/docs/v1/tech/lambdas/).

### {frontmatter.technology} Authentication

- [Laravel Socialite concepts](https://laravel.com/docs/10.x/socialite)

## Troubleshooting

### "This site can’t be reached localhost refused to connect" When I Click The Login Button
Ensure FusionAuth is running in the Docker container. You should be able to log in as the admin user `admin@example.com` with a password of `password` at [http://localhost:9011/admin](http://localhost:9011/admin).

### Docker Complains That The Container `lara_app` Is Already Running
Run the following command to stop and remove all existing Docker containers then try to start them again.

```bash
docker stop $(docker ps -a -q) && docker rm $(docker ps -a -q)
```

### {frontmatter.technology} Says There Is An Invalid State Exception
Browse back to the homepage. Log out. Try log in again. If that still doesn't work, delete and restart all the containers.

### It Still Doesn't Work.
You can always pull down a complete running application and compare what's different.

```
git clone https://github.com/ritza-co/fusionauth-quickstart-php-laravel-web.git
docker stop $(docker ps -a -q) && docker rm $(docker ps -a -q)
cd fusionauth-quickstart-php-laravel-web/complete-application
docker-compose up -d
docker compose exec lara_app      composer install
docker compose exec lara_app      php artisan migrate
```