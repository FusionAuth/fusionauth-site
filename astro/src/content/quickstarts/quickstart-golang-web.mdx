---
title: Golang and FusionAuth
description: Quickstart integration of a Golang web application with FusionAuth using the CoreOS OIDC library
navcategory: getting-started
prerequisites: Go 1.16
section: web
technology: CoreOS go-oidc
language: Golang
coderoot: https://raw.githubusercontent.com/FusionAuth/fusionauth-example-go/andrewpai/quickstart-rewrite
---
import Aside from '/src/components/Aside.astro';
import RemoteCode from '/src/components/RemoteCode.astro';

export const coderoot = "https://raw.githubusercontent.com/FusionAuth/fusionauth-example-go/andrewpai/quickstart-rewrite"

This Quickstart will take you through building a simple Go web application and integrating it
with FusionAuth. It uses CoreOS's go-oidc library, and sets  up an OAuth authorization code grant flow, 
allowing users to log into the application.

In this Quickstart you'll create the Changebank application, which has
* A Home Page, which is where a logged-out user goes. It has a login button that allows a user to log in
  using FusionAuth
* An Account Page, which is where a user goes when they're logged in. It has a Logout button that allows
  the user to log out with FusionAuth
* The associated back end routes to accomplish all of this

This quickstart will be referencing code in the example application in the [Golang Quickstart Repo](https://github.com/FusionAuth/fusionauth-quickstart-golang-web).
You can find a fully-working version of this application there.

#### Repository Contents
| Item | Description |
| --- | --- |
| /docker-compose.yml | A docker-compose config file for standing up a FusionAuth server, a Postgres database, and an Elastic instance |
| /kickstart/ | A directory containing a `kickstart` file, which is used to configure FusionAuth |
| /complete-application/ | A completed application, with a working integration with FusionAuth |

## Prerequisites
* [git](https://git-scm.com/downloads): This will be needed for grabbing the code.
* [Go v1.16](https://go.dev/doc/install)
* [Docker](https://www.docker.com): The quickest way to stand up FusionAuth. (There are [other ways](https://fusionauth.io/docs/v1/tech/installation-guide/)).

The commands below are for macOS, but are limited to basic *nix commands.

## Getting Started
In this section, you'll get FusionAuth up and running, and configured with the ChangeBank application.

### Clone the Code
First off, grab the code from the repository and change into that directory.

```
git clone https://github.com/FusionAuth/fusionauth-quickstart-golang-web.git
cd fusionauth-quickstart-golang-web
```

### Run FusionAuth via Docker

In the root directory of the repo you'll find a Docker compose file (docker-compose.yml) and an environment
variables configuration file (.env). Assuming you have Docker installed on your machine, you can stand up
FusionAuth up on your machine with:

```
docker-compose up -d
```

This will start three containers, once each for FusionAuth, Postgres, and Elastic.

Here you are using a bootstrapping feature of FusionAuth, called [Kickstart](/docs/v1/tech/installation-guide/kickstart).
When FusionAuth comes up for the first time, it will look at the `kickstart/kickstart.json` file and
configure FusionAuth to a certain initial state.

<Aside type="note">
If you ever want to reset the FusionAuth system, delete the volumes created by docker-compose by
executing `docker-compose down -v`, then re-run `docker-compose up -d`.
</Aside>

FusionAuth will be configured with these settings
* Your client Id is `e9fdb985-9173-4e01-9d73-ac2d60d1dc8e`.
* Your client secret is `super-secret-secret-that-should-be-regenerated-for-production`.
* Your example username is `richard@example.com` and the password is `password`.
* Your admin username is `admin@example.com` and the password is `password`.
* The base URL of FusionAuth `http://localhost:9011/`.

You can log into the [FusionAuth admin UI](http://localhost:9011/admin) and look around if you want, but with Docker/Kickstart you donâ€™t need to.

### Create a Basic Golang Application
In this section, you'll set up a basic Golang application with a single page.

#### Setup Your Environment
Create a new directory to hold your application, and go into it.

```shell
mkdir changebank
cd changebank
```

Create a go.mod file listing these dependencies:

`go.mod`
<RemoteCode url="https://raw.githubusercontent.com/FusionAuth/fusionauth-example-go/andrewpai/quickstart-rewrite/complete-application/go.mod"
  lang="go" />

#### Create the Application
Now create a base Go app, which will consist of a single file named main.go. You can either copy the code shown
here, or you can copy the file `/complete-application/base-app.go` from the quickstart repo and name it `main.go`.

This app sets up a handful of routes that just serve a home page for now. Over the course of this quickstart 
you'll be modifying each of these route handler functions to complete the integration with FusionAuth.

`main.go`
<RemoteCode url={frontmatter.coderoot + "/complete-application/base-app.go"}
 lang="go"
 tags="baseApplication"/>

And then load your dependencies and generate go.sum

```shell
go mod download all
```

<Aside type="tip">
You should be able to start your Go application with `go run main.go`.
Note that you won't be able to access it with a browser yet!
</Aside>

#### Create a Home Page
The next step is to get a basic home page up and running. We'll take this opportunity to copy in all 
of the static assets that you'll need for the application, including web page templates, images, and CSS.

Run the following copy commads to copy these files from the quickstart repo into your project. This assumes
that you checked the quickstart repo out into the parent directory. If that's not the case, replace the
`..` below with your actual repo location.

```shell
cp -r ../fusionauth-quickstart-go-web/complete-application/templates . && \
cp -r ../fusionauth-quickstart-go-web/complete-application/static .
```

<Aside type="tip">
With the home page template in place, you can view the home page in your brower at http://localhost:8080!
</Aside>

## Authentication
In this section, you'll add the ability for a user to log in to your application using FusionAuth as the identity provider.
To accomplish this, you'll do the following.
* Configure an OIDC client
* Modify the `/login` route to redirect the user to FusionAuth to log in
* Add code to the `/callback` route to accept the redirect from FusionAuth and to exchange an authorization code for an access token
* Add protection to the `/account` route to only allow access by logged-in users
* Modify the `/` route to detect if a user is logged in, and take them to `/account` when they are
* Add a `/logout` endpoint

### Configure the OIDC Client
The CoreOS OpenID Connect client needs to be set up so that it knows how to talk to FusionAuth.

First, create some constants that you can use throughout your program. Put these after your `import` block and before `func main()`.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="oidcConstants"/>

<Aside type="note">
If you want to see where the FusionAuth values came from, they can be found in the 
FusionAuth app (http://localhost:9011/admin). The tenant ID is found on the Tenants
page. To see the client ID and client secret, go to the Applications page and 
click the `View` icon under the actions for the Changebank application. You'll 
find the client id and client secret values in the `OAuth configuration` section.
</Aside>

Next, create variables for the OAuth config and the OIDC provicer, and initialize
them in an `init()` function. Put this code after the `const` block you just added.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="oidcClient"/>

You'll also need to add some additional imports. Modify your `import` block to look like this.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="imports"/>

### Modify the `/login` Route
When the user clicks the `Login` button in your Changebank app, they'll be 
taken to your `/login` endpoint. Have this redirect them to FusionAuth so that
FusionAuth can present them with a login page. Change the `handleLoginRequest`
function to do that.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="loginRoute"/>

The `Login` button on your home page will now take you to FusionAuth to log in. 
You can log in, but nothing will happen after you do until you add the callback 
handler in the next section.

### Handle the OAuth Callback
After the user successfully authenticates with FusionAuth, FusionAuth will redirect
the user back to your application along with an authorization code. Your application
needs to exchange this code for an access token using FusionAuth's token endpoint.
This is the defining action of the OAuth code grant flow. An access token can
only be acquired for a user by an application that has a valid authorization code, 
as well as a valid client ID and client secret.

Modify the `handleFusionAuthCallback` function to do this.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="callbackRoute"/>

This function writes three tokens out to HTTP-only cookies. This means they aren't 
available to code running in the browser, but they'll be sent back to your go
application when requests are made to the back end.

### Create a Protected Web Page
The `/account` page represents what a user sees when they're logged into their
Changebank account. A user that isn't logged in, who tries to access this page, 
should just be taken to the home page.

Edit the `handleAccount()` function to do this. There is also a `getLogoutUrl()` 
function that you'll need to add. 

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="accountRoute"/>

<Aside type="tip">
At this point, you should be able to successfully log into your application!
</Aside>

### Change the Home Route
Next you'll modify the `handleMain()` function to automatically take a logged-in
user to their account page.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="accountRoute"/>

### Implement Logout
The last step is to implement logout. When you log a user out of an application, you'll take them to 
FusionAuth's `/oauth2/logout` endpoint. After logging the user out, FusionAuth will redirect the user
to your app's `/logout` endpoint, which you'll create now. This endpoint deletes any cookies that your
application created, clearing the user's session.

Update the `handleLogout()` function to do this.

<RemoteCode url={frontmatter.coderoot + "/complete-application/main.go"}
 lang="go"
 tags="logoutRoute"/>

<Aside type="tip">
Click the `Logout` button and watch the browser first go to FusionAuth to log out the user, then return to your home page.
</Aside>

## Next Steps
This quickstart is a great way to get a proof of concept up and running quickly, but to run 
you application in production, there are some things you're going to want to do.

### Customization
FusionAuth gives you the ability to customize just about everything with the user's experience and your application's integration. This includes
* Hosted pages such as login, registration, email verification, and many more
* Email templates
* User data and custom claims in access token JWTs

### Security
* Properly validate the user's logged-in state.
  * Validate the access token's signature
  * Check that it isn't expired
* Add token refresh
  * If a user has an expired token (or even if they don't), use their refresh token to acquire a new one. If refresh fails,
    that means it's time for the user to log in again
* Add token validation and refresh into a function decorator or middleware that can be easily applied to any route
* Choose password rules and a hashing algorithm that meet your security needs

### Tenant and Application Management
* Model your application topology using Applications, Roles, Groups, Entities, and more
* Set up password rules, MFA, Social login, and/or SAML integrations
* Integrate with external systems using Webhooks, SCIM, and Lambdas
