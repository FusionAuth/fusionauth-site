import {RemoteCode} from '@fusionauth/astro-components';

There is a route that corresponds to the URL you configured in the FusionAuth admin user interface above (`https://localhost:3000/oauth-redirect`). This is critical functionality, so let's take a closer look at this.

Here's the complete code for exchanging the token, retrieving the user data, storing it in the session, and redirecting the user.

<RemoteCode lang="javascript"
            url="https://raw.githubusercontent.com/FusionAuth/fusionauth-example-5-minute-guide/master/routes/index.js"
            tags="fullOAuthCodeExchange"
            title="The Complete OAuth Code Exchange Function" />

This route retrieves the `code` parameter from the request and exchanges it for an access token. This access token can be used for a variety of purposes, but in this tutorial is used to retrieve user data from FusionAuth.

Once you have the User object, it is stored in a server side session so that it can be used in other parts of the application. This includes a view where it is used to greet the user.

There are other options for storing this user object, but for this tutorial, this will work fine. If you want to learn more, such as other patterns for storing the token, please check out [these articles about login workflows](/learn/expert-advice/authentication/login-authentication-workflows).

The final thing this code does is redirect the authorized user back to the homepage. There, they'll be greeted by name, as you'll see below.

