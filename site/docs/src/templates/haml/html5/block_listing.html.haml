%div{:id=>@id, :class=>["bg-gray-900 my-5 rounded-lg", role]}
  -if title?
    %div{:class=>"border-b border-b-blue-300 pl-5 py-2 text-blue-300 text-xs"}=captioned_title
  - nowrap = !(@document.attr? :prewrap) || (option? :nowrap)
  - if @style == 'source'
    - code_lang = attr :language, nil, false
    - code_class = ["language-#{code_lang}"] if code_lang
    - pre_class = ['highlight']
    - pre_lang = nil
    - case document.attr 'source-highlighter'
      - when 'coderay'
        - pre_class.unshift 'CodeRay'
        - code_class = nil
      - when 'pygments'
        - pre_class.unshift 'pygments'
        - code_class = nil
      - when 'highlightjs', 'highlight.js'
        - pre_class.unshift 'highlightjs'
      - when 'prettify'
        - pre_class.unshift 'prettyprint'
        - pre_class << 'linenums' if attr? :linenums
      - when 'html-pipeline'
        - pre_lang = code_lang
        - code_class = code_lang = pre_class = nil
        - nowrap = false
    - pre_class << 'nowrap' if nowrap
    - if ! (@document.attr? :code_id).nil?
      %pre{:class=>[pre_class, "m-0 p-5"], :lang=>pre_lang}
        %code{:id=>(@document.attr :code_id), :class=>code_class, 'data-lang'=>code_lang}=content
    - else
      %pre{:class=>[pre_class, "m-0 p-5"], :lang=>pre_lang}
        %code{:class=>code_class, 'data-lang'=>code_lang}=content
  - else
    %pre{:class=>[("whitespace-nowrap" if nowrap), "m-0 p-5"]}=content
